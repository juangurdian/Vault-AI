{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/lib/hooks/useOffline.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport function useOffline() {\r\n  const [offline, setOffline] = useState<boolean>(\r\n    typeof navigator !== \"undefined\" ? !navigator.onLine : false\r\n  );\r\n\r\n  useEffect(() => {\r\n    const handleOnline = () => setOffline(false);\r\n    const handleOffline = () => setOffline(true);\r\n    window.addEventListener(\"online\", handleOnline);\r\n    window.addEventListener(\"offline\", handleOffline);\r\n    return () => {\r\n      window.removeEventListener(\"online\", handleOnline);\r\n      window.removeEventListener(\"offline\", handleOffline);\r\n    };\r\n  }, []);\r\n\r\n  return offline;\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAIO,SAAS;IACd,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EACpC,OAAO,cAAc,cAAc,CAAC,UAAU,MAAM,GAAG;IAGzD,IAAA,8NAAS,EAAC;QACR,MAAM,eAAe,IAAM,WAAW;QACtC,MAAM,gBAAgB,IAAM,WAAW;QACvC,OAAO,gBAAgB,CAAC,UAAU;QAClC,OAAO,gBAAgB,CAAC,WAAW;QACnC,OAAO;YACL,OAAO,mBAAmB,CAAC,UAAU;YACrC,OAAO,mBAAmB,CAAC,WAAW;QACxC;IACF,GAAG,EAAE;IAEL,OAAO;AACT"}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/lib/stores/chat.ts"],"sourcesContent":["\"use client\";\r\nimport { create } from \"zustand\";\r\nimport { persist, createJSONStorage } from \"zustand/middleware\";\r\nimport type { Conversation, Message, Role, RoutingInfo } from \"@/components/chat/types\";\r\n\r\ntype ChatState = {\r\n  conversations: Record<string, Conversation>;\r\n  activeId: string | null;\r\n  isGenerating: boolean;\r\n  routingInfo: Record<string, RoutingInfo | null>;\r\n  currentModel: Record<string, string | null>;\r\n  selectedModel: string; // \"auto\" or specific model name\r\n  smartRoutingEnabled: boolean; // Whether to use intelligent routing\r\n  createConversation: (title?: string) => string;\r\n  setActiveConversation: (id: string) => void;\r\n  setRoutingInfo: (conversationId: string, info: RoutingInfo | null) => void;\r\n  addMessage: (message: Partial<Message> & { role: Role; content: string }, conversationId?: string) => void;\r\n  replaceMessages: (conversationId: string, messages: Message[]) => void;\r\n  deleteConversation: (id: string) => void;\r\n  setIsGenerating: (val: boolean) => void;\r\n  setSelectedModel: (model: string) => void;\r\n  setSmartRoutingEnabled: (enabled: boolean) => void;\r\n  reset: () => void;\r\n};\r\n\r\nconst newConversation = (title = \"New chat\"): Conversation => {\r\n  const now = Date.now();\r\n  return {\r\n    id: crypto.randomUUID(),\r\n    title,\r\n    createdAt: now,\r\n    updatedAt: now,\r\n    messages: [],\r\n  };\r\n};\r\n\r\n// Create the store with persist middleware\r\nexport const useChatStore = create<ChatState>()(\r\n  persist(\r\n    (set, get) => ({\r\n      conversations: {},\r\n      activeId: null,\r\n      isGenerating: false,\r\n      routingInfo: {},\r\n      currentModel: {},\r\n      selectedModel: \"auto\",\r\n      smartRoutingEnabled: true,\r\n\r\n      createConversation: (title) => {\r\n        const convo = newConversation(title);\r\n        set((state) => ({\r\n          conversations: { ...state.conversations, [convo.id]: convo },\r\n          activeId: convo.id,\r\n        }));\r\n        return convo.id;\r\n      },\r\n\r\n      setActiveConversation: (id) => {\r\n        if (get().conversations[id]) {\r\n          set({ activeId: id });\r\n        }\r\n      },\r\n\r\n      setRoutingInfo: (conversationId, info) => {\r\n        set((state) => ({\r\n          routingInfo: {\r\n            ...state.routingInfo,\r\n            [conversationId]: info,\r\n          },\r\n          currentModel: {\r\n            ...state.currentModel,\r\n            [conversationId]: info?.model ?? state.currentModel[conversationId] ?? null,\r\n          },\r\n        }));\r\n      },\r\n\r\n      addMessage: (message, conversationId) => {\r\n        const convId = conversationId || get().activeId;\r\n        if (!convId) return;\r\n\r\n        set((state) => {\r\n          const existing = state.conversations[convId];\r\n          if (!existing) return state;\r\n\r\n          const msg: Message = {\r\n            id: message.id || crypto.randomUUID(),\r\n            role: message.role,\r\n            content: message.content,\r\n            createdAt: message.createdAt || Date.now(),\r\n          };\r\n\r\n          const shouldUpdateTitle =\r\n            existing.messages.length === 0 && message.role === \"user\" && message.content;\r\n\r\n          const updated: Conversation = {\r\n            ...existing,\r\n            messages: [...existing.messages, msg],\r\n            updatedAt: msg.createdAt,\r\n            title: shouldUpdateTitle\r\n              ? (message.content || \"New chat\").slice(0, 60)\r\n              : existing.title,\r\n          };\r\n\r\n          return {\r\n            conversations: { ...state.conversations, [convId]: updated },\r\n          };\r\n        });\r\n      },\r\n\r\n      replaceMessages: (conversationId, messages) => {\r\n        set((state) => {\r\n          const existing = state.conversations[conversationId];\r\n          if (!existing) return state;\r\n          const updated: Conversation = {\r\n            ...existing,\r\n            messages,\r\n            updatedAt: Date.now(),\r\n          };\r\n          return { conversations: { ...state.conversations, [conversationId]: updated } };\r\n        });\r\n      },\r\n\r\n      deleteConversation: (id) => {\r\n        set((state) => {\r\n          const { [id]: _, ...rest } = state.conversations;\r\n          const newActive = state.activeId === id ? Object.keys(rest)[0] ?? null : state.activeId;\r\n          return { conversations: rest, activeId: newActive };\r\n        });\r\n      },\r\n\r\n      setIsGenerating: (val) => set({ isGenerating: val }),\r\n\r\n      setSelectedModel: (model) => set({ selectedModel: model }),\r\n\r\n      setSmartRoutingEnabled: (enabled) => set({ smartRoutingEnabled: enabled }),\r\n\r\n      reset: () =>\r\n        set({\r\n          conversations: {},\r\n          activeId: null,\r\n          isGenerating: false,\r\n          routingInfo: {},\r\n          currentModel: {},\r\n          selectedModel: \"auto\",\r\n          smartRoutingEnabled: true,\r\n        }),\r\n    }),\r\n    {\r\n      name: \"beast-chat-store\",\r\n      storage: createJSONStorage(() => {\r\n        // Only use localStorage on client side\r\n        if (typeof window === \"undefined\") {\r\n          return {\r\n            getItem: () => null,\r\n            setItem: () => {},\r\n            removeItem: () => {},\r\n          };\r\n        }\r\n        return window.localStorage;\r\n      }),\r\n      version: 1,\r\n      // Skip hydration during SSR - we'll hydrate on client only\r\n      skipHydration: true,\r\n    }\r\n  )\r\n);\r\n\r\n// Hydrate on client side only\r\nif (typeof window !== \"undefined\") {\r\n  useChatStore.persist.rehydrate();\r\n}\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 192, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/layout/Header.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useOffline } from \"@/lib/hooks/useOffline\";\nimport { useChatStore } from \"@/lib/stores/chat\";\n\ntype ModelInfo = {\n  name: string;\n  model_type: string;\n  display_name: string;\n  description: string;\n  estimated_tokens_per_sec: number;\n  is_available: boolean;\n};\n\nconst API_BASE =\n  (typeof process !== \"undefined\" && process.env.NEXT_PUBLIC_API_BASE) ||\n  \"http://localhost:8001/api\";\n\ntype HeaderProps = {\n  onMenuClick?: () => void;\n};\n\nexport default function Header({ onMenuClick }: HeaderProps = {}) {\n  const offline = useOffline();\n  \n  const selectedModel = useChatStore((s) => s.selectedModel);\n  const setSelectedModel = useChatStore((s) => s.setSelectedModel);\n  const smartRoutingEnabled = useChatStore((s) => s.smartRoutingEnabled);\n  const setSmartRoutingEnabled = useChatStore((s) => s.setSmartRoutingEnabled);\n  \n  const [models, setModels] = useState<ModelInfo[]>([]);\n  const [routerStatus, setRouterStatus] = useState<\"online\" | \"offline\" | \"checking\">(\"checking\");\n\n  // Fetch models from API\n  useEffect(() => {\n    async function fetchModels() {\n      try {\n        // When smart routing is off, fetch all models (including embeddings)\n        // When smart routing is on, only fetch chat models\n        const url = smartRoutingEnabled \n          ? `${API_BASE}/models` \n          : `${API_BASE}/models?include_all=true`;\n        const response = await fetch(url);\n        if (response.ok) {\n          const data = await response.json();\n          setModels(data.models || []);\n          setRouterStatus(\"online\");\n        } else {\n          setRouterStatus(\"offline\");\n        }\n      } catch {\n        setRouterStatus(\"offline\");\n      }\n    }\n    \n    fetchModels();\n    // Refresh every 30 seconds\n    const interval = setInterval(fetchModels, 30000);\n    return () => clearInterval(interval);\n  }, [smartRoutingEnabled]);\n\n  const status = useMemo(\n    () => [\n      { \n        label: \"Router\", \n        state: routerStatus, \n        color: routerStatus === \"online\" ? \"bg-emerald-400\" : routerStatus === \"checking\" ? \"bg-yellow-400\" : \"bg-red-400\" \n      },\n      { \n        label: \"Network\", \n        state: offline ? \"offline\" : \"online\", \n        color: offline ? \"bg-amber-400\" : \"bg-emerald-400\" \n      },\n    ],\n    [offline, routerStatus]\n  );\n\n  // Group models by type\n  const modelsByType = useMemo(() => {\n    const grouped: Record<string, ModelInfo[]> = {};\n    for (const model of models) {\n      if (!grouped[model.model_type]) {\n        grouped[model.model_type] = [];\n      }\n      grouped[model.model_type].push(model);\n    }\n    return grouped;\n  }, [models]);\n\n  // Get the effective model (what will actually be used)\n  const effectiveModel = smartRoutingEnabled ? \"auto\" : selectedModel;\n\n  // Handle toggle change\n  const handleToggle = () => {\n    const newEnabled = !smartRoutingEnabled;\n    setSmartRoutingEnabled(newEnabled);\n    \n    // When enabling smart routing, ensure model is set to auto\n    if (newEnabled) {\n      setSelectedModel(\"auto\");\n    } else if (selectedModel === \"auto\" && models.length > 0) {\n      // When disabling, default to first available model if currently on auto\n      setSelectedModel(models[0].name);\n    }\n  };\n\n  return (\n    <header className=\"shrink-0 border-b border-slate-900/70 bg-slate-950/90 px-4 py-3 backdrop-blur sm:px-6 lg:px-8\">\n      <div className=\"flex items-center justify-between gap-4\">\n        {/* Left: Menu button (mobile) + Title + Status */}\n        <div className=\"flex items-center gap-4\">\n          {onMenuClick && (\n            <button\n              onClick={onMenuClick}\n              className=\"md:hidden rounded p-1.5 text-slate-400 hover:text-slate-200 hover:bg-slate-800/50\"\n              aria-label=\"Toggle menu\"\n            >\n              <svg className=\"h-6 w-6\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 6h16M4 12h16M4 18h16\" />\n              </svg>\n            </button>\n          )}\n          <div>\n            <div className=\"flex items-center gap-2\">\n              <h1 className=\"text-lg font-bold text-slate-50\">LocalAI</h1>\n            </div>\n            <p className=\"text-xs text-slate-500\">\n              {routerStatus === \"online\" \n                ? `${models.length} models ‚Ä¢ ${smartRoutingEnabled ? \"Smart routing\" : \"Manual mode\"}`\n                : \"Connecting to router...\"}\n            </p>\n          </div>\n          \n          {/* Status indicators */}\n          <div className=\"hidden items-center gap-2 sm:flex\">\n            {status.map((item) => (\n              <span\n                key={item.label}\n                className=\"inline-flex items-center gap-1.5 rounded-full bg-slate-900/80 px-2.5 py-1 text-[10px] text-slate-300 ring-1 ring-slate-800\"\n              >\n                <span className={`h-1.5 w-1.5 rounded-full ${item.color}`} />\n                {item.label}\n              </span>\n            ))}\n          </div>\n        </div>\n\n        {/* Right: Smart routing toggle + Model selector */}\n        <div className=\"flex items-center gap-2 sm:gap-3\">\n          {/* Smart Routing Toggle */}\n          <button\n            onClick={handleToggle}\n            className={`group flex items-center gap-1.5 sm:gap-2 rounded-lg border px-2 sm:px-3 py-1.5 text-xs font-medium transition ${\n              smartRoutingEnabled\n                ? \"border-cyan-500/50 bg-cyan-500/10 text-cyan-300 hover:bg-cyan-500/20\"\n                : \"border-slate-700 bg-slate-900/60 text-slate-400 hover:border-slate-600 hover:text-slate-300\"\n            }`}\n            title={smartRoutingEnabled ? \"Smart routing is ON - AI selects the best model\" : \"Smart routing is OFF - You choose the model\"}\n          >\n            {/* Toggle indicator */}\n            <div className={`relative h-4 w-7 rounded-full transition-colors ${\n              smartRoutingEnabled ? \"bg-cyan-500\" : \"bg-slate-700\"\n            }`}>\n              <div className={`absolute top-0.5 h-3 w-3 rounded-full bg-white shadow transition-transform ${\n                smartRoutingEnabled ? \"translate-x-3.5\" : \"translate-x-0.5\"\n              }`} />\n            </div>\n            <span className=\"hidden sm:inline\">\n              {smartRoutingEnabled ? \"Smart\" : \"Manual\"}\n            </span>\n            {/* Brain/Hand icon */}\n            <span className=\"text-sm\">\n              {smartRoutingEnabled ? \"üß†\" : \"‚úã\"}\n            </span>\n          </button>\n\n          {/* Model selector */}\n          <div className=\"flex items-center gap-2\">\n            <select\n              className={`min-w-[120px] sm:min-w-[160px] rounded-lg border px-2 sm:px-3 py-1.5 text-xs outline-none ring-1 ring-transparent transition focus:ring-cyan-500 ${\n                smartRoutingEnabled\n                  ? \"cursor-not-allowed border-slate-800 bg-slate-900/50 text-slate-500\"\n                  : \"border-slate-700 bg-slate-900 text-slate-100 hover:border-slate-600\"\n              }`}\n              value={effectiveModel}\n              onChange={(e) => setSelectedModel(e.target.value)}\n              disabled={smartRoutingEnabled}\n              aria-label=\"Select model\"\n            >\n              {smartRoutingEnabled ? (\n                <option value=\"auto\">Auto (AI selects)</option>\n              ) : (\n                <>\n                  {Object.entries(modelsByType).map(([type, typeModels]) => (\n                    <optgroup key={type} label={type.charAt(0).toUpperCase() + type.slice(1)}>\n                      {typeModels.map((m) => (\n                        <option key={m.name} value={m.name}>\n                          {m.display_name} ‚Äî {m.estimated_tokens_per_sec}t/s\n                        </option>\n                      ))}\n                    </optgroup>\n                  ))}\n                </>\n              )}\n            </select>\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 493, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/lib/hooks/useHydrated.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\n\r\nexport function useHydrated() {\r\n  const [hydrated, setHydrated] = useState(false);\r\n  useEffect(() => {\r\n    setHydrated(true);\r\n  }, []);\r\n  return hydrated;\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AAFA;;AAIO,SAAS;IACd,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,6NAAQ,EAAC;IACzC,IAAA,8NAAS,EAAC;QACR,YAAY;IACd,GAAG,EAAE;IACL,OAAO;AACT"}},
    {"offset": {"line": 511, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/layout/Sidebar.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport { useChatStore } from \"@/lib/stores/chat\";\nimport { useHydrated } from \"@/lib/hooks/useHydrated\";\n\ntype SidebarProps = {\n  onClose?: () => void;\n};\n\nexport default function Sidebar({ onClose }: SidebarProps) {\n  const hydrated = useHydrated();\n  const [deleteConfirmId, setDeleteConfirmId] = useState<string | null>(null);\n  \n  // Use individual selectors to prevent infinite re-renders from object selector\n  const conversations = useChatStore((state) => state.conversations);\n  const activeId = useChatStore((state) => state.activeId);\n  const setActiveConversation = useChatStore((state) => state.setActiveConversation);\n  const createConversation = useChatStore((state) => state.createConversation);\n  const deleteConversation = useChatStore((state) => state.deleteConversation);\n  \n  const handleConversationClick = (id: string) => {\n    if (deleteConfirmId === id) return; // Don't select if confirming delete\n    setActiveConversation(id);\n    onClose?.();\n  };\n\n  const handleDeleteClick = (e: React.MouseEvent, id: string) => {\n    e.stopPropagation(); // Prevent conversation selection\n    setDeleteConfirmId(id);\n  };\n\n  const handleDeleteConfirm = (e: React.MouseEvent, id: string) => {\n    e.stopPropagation();\n    deleteConversation(id);\n    setDeleteConfirmId(null);\n    onClose?.();\n  };\n\n  const handleDeleteCancel = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    setDeleteConfirmId(null);\n  };\n\n  const list = useMemo(\n    () => Object.values(conversations).sort((a, b) => b.updatedAt - a.updatedAt),\n    [conversations]\n  );\n\n  const handleNewChat = () => {\n    const id = createConversation(\"New chat\");\n    setActiveConversation(id);\n  };\n\n  return (\n    <aside className=\"h-full w-[260px] flex-col border-r border-slate-900/70 bg-slate-950/80 md:flex lg:w-[300px]\">\n      {hydrated ? (\n        <>\n          {/* Header */}\n          <div className=\"shrink-0 border-b border-slate-900/70 px-4 py-4\">\n            <div className=\"flex items-center justify-between\">\n              <div>\n                <p className=\"text-[10px] font-semibold uppercase tracking-widest text-cyan-400\">Status</p>\n                <p className=\"text-sm text-slate-200\">Online &amp; ready</p>\n              </div>\n              <div className=\"flex items-center gap-2\">\n                {onClose && (\n                  <button\n                    onClick={onClose}\n                    className=\"md:hidden rounded p-1 text-slate-400 hover:text-slate-200\"\n                    aria-label=\"Close sidebar\"\n                  >\n                    <svg className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                    </svg>\n                  </button>\n                )}\n                <span className=\"h-2.5 w-2.5 rounded-full bg-emerald-400 shadow-[0_0_8px_rgba(16,185,129,0.5)]\" />\n              </div>\n            </div>\n          </div>\n\n          {/* Conversations header + button */}\n          <div className=\"shrink-0 flex items-center justify-between px-4 py-3\">\n            <p className=\"text-[10px] font-semibold uppercase tracking-widest text-cyan-400\">\n              Conversations\n            </p>\n            <button\n              onClick={handleNewChat}\n              className=\"rounded-lg bg-cyan-500/20 px-2.5 py-1 text-[10px] font-semibold text-cyan-300 transition hover:bg-cyan-500/30\"\n            >\n              + New\n            </button>\n          </div>\n\n          {/* Scrollable conversation list */}\n          <nav className=\"scrollbar-thin min-h-0 flex-1 overflow-y-auto px-3\">\n            <div className=\"space-y-1.5 pt-1 pb-4\">\n              {list.length === 0 && (\n                <div className=\"rounded-lg border border-dashed border-slate-800 bg-slate-900/40 px-3 py-3 text-center text-xs text-slate-500\">\n                  No conversations yet\n                </div>\n              )}\n              {list.map((item) => (\n                <div\n                  key={item.id}\n                  className={`group relative w-full rounded-lg transition ${\n                    activeId === item.id\n                      ? \"bg-cyan-500/15 ring-1 ring-cyan-500/40\"\n                      : \"hover:bg-slate-900/60\"\n                  }`}\n                >\n                  <button\n                    onClick={() => handleConversationClick(item.id)}\n                    className=\"w-full px-3 py-2.5 text-left\"\n                  >\n                    <div className=\"flex items-center justify-between pr-8\">\n                      <span className=\"truncate text-sm font-medium text-slate-100\">\n                        {item.title || \"Untitled chat\"}\n                      </span>\n                      <span className=\"ml-2 shrink-0 text-[10px] text-slate-500\">\n                        {item.messages.length}\n                      </span>\n                    </div>\n                    <p className=\"mt-0.5 truncate text-xs text-slate-500\">\n                      {item.messages[item.messages.length - 1]?.content || \"No messages\"}\n                    </p>\n                  </button>\n                  \n                  {/* Delete button - shows on hover or when confirming */}\n                  {deleteConfirmId === item.id ? (\n                    <div className=\"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1 rounded bg-red-500/20 px-2 py-1 ring-1 ring-red-500/50\">\n                      <button\n                        onClick={(e) => handleDeleteConfirm(e, item.id)}\n                        className=\"text-[10px] font-medium text-red-300 hover:text-red-200\"\n                        title=\"Confirm delete\"\n                      >\n                        Delete\n                      </button>\n                      <button\n                        onClick={handleDeleteCancel}\n                        className=\"text-[10px] font-medium text-slate-400 hover:text-slate-200\"\n                        title=\"Cancel\"\n                      >\n                        √ó\n                      </button>\n                    </div>\n                  ) : (\n                    <button\n                      onClick={(e) => handleDeleteClick(e, item.id)}\n                      className=\"absolute right-2 top-1/2 -translate-y-1/2 rounded p-1 text-slate-500 opacity-0 transition hover:bg-red-500/20 hover:text-red-400 group-hover:opacity-100\"\n                      title=\"Delete conversation\"\n                      aria-label=\"Delete conversation\"\n                    >\n                      <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                      </svg>\n                    </button>\n                  )}\n                </div>\n              ))}\n            </div>\n          </nav>\n\n          {/* Footer */}\n          <div className=\"shrink-0 border-t border-slate-900/70 px-4 py-3\">\n            <p className=\"text-[10px] font-semibold uppercase tracking-widest text-slate-600\">\n              Backend\n            </p>\n            <p className=\"text-xs text-slate-400\">localhost:8001</p>\n          </div>\n        </>\n      ) : (\n        <>\n          <div className=\"shrink-0 border-b border-slate-900/70 px-4 py-4\">\n            <div className=\"h-10 animate-pulse rounded bg-slate-900/80\" />\n          </div>\n          <div className=\"flex-1 px-3 py-3\">\n            <div className=\"space-y-2\">\n              {[...Array(5)].map((_, idx) => (\n                <div key={idx} className=\"h-14 animate-pulse rounded-lg bg-slate-900/60\" />\n              ))}\n            </div>\n          </div>\n        </>\n      )}\n    </aside>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 885, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/lib/stores/app.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { create } from \"zustand\";\r\nimport { persist, createJSONStorage } from \"zustand/middleware\";\r\n\r\nexport type AppMode = \"chat\" | \"research\" | \"code\" | \"image\";\r\n\r\ntype AppState = {\r\n  mode: AppMode;\r\n  setMode: (mode: AppMode) => void;\r\n};\r\n\r\nexport const useAppStore = create<AppState>()(\r\n  persist(\r\n    (set) => ({\r\n      mode: \"chat\",\r\n      setMode: (mode) => set({ mode }),\r\n    }),\r\n    {\r\n      name: \"beast-app-store\",\r\n      storage: createJSONStorage(() => {\r\n        if (typeof window === \"undefined\") {\r\n          return {\r\n            getItem: () => null,\r\n            setItem: () => {},\r\n            removeItem: () => {},\r\n          };\r\n        }\r\n        return window.localStorage;\r\n      }),\r\n      skipHydration: true,\r\n    }\r\n  )\r\n);\r\n\r\nif (typeof window !== \"undefined\") {\r\n  useAppStore.persist.rehydrate();\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAYO,MAAM,cAAc,IAAA,8JAAM,IAC/B,IAAA,oKAAO,EACL,CAAC,MAAQ,CAAC;QACR,MAAM;QACN,SAAS,CAAC,OAAS,IAAI;gBAAE;YAAK;IAChC,CAAC,GACD;IACE,MAAM;IACN,SAAS,IAAA,8KAAiB,EAAC;QACzB,wCAAmC;YACjC,OAAO;gBACL,SAAS,IAAM;gBACf,SAAS,KAAO;gBAChB,YAAY,KAAO;YACrB;QACF;;;IAEF;IACA,eAAe;AACjB;AAIJ"}},
    {"offset": {"line": 920, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/layout/StatusBar.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState, useCallback } from \"react\";\nimport { useChatStore } from \"@/lib/stores/chat\";\nimport { useAppStore } from \"@/lib/stores/app\";\n\nconst API_BASE =\n  (typeof process !== \"undefined\" && process.env.NEXT_PUBLIC_API_BASE) ||\n  \"http://localhost:8001/api\";\n\ntype OllamaStatus = \"checking\" | \"online\" | \"offline\";\n\ntype HealthData = {\n  status: string;\n  models_available: number;\n  llm_routing_enabled: boolean;\n  routing_model: string;\n};\n\nexport default function StatusBar() {\n  const selectedModel = useChatStore((s) => s.selectedModel);\n  const smartRoutingEnabled = useChatStore((s) => s.smartRoutingEnabled);\n  const appMode = useAppStore((s) => s.mode);\n\n  const [ollamaStatus, setOllamaStatus] = useState<OllamaStatus>(\"checking\");\n  const [healthData, setHealthData] = useState<HealthData | null>(null);\n\n  const checkHealth = useCallback(async () => {\n    try {\n      const res = await fetch(\"http://localhost:8001/health\", { cache: \"no-store\" });\n      if (res.ok) {\n        const data: HealthData = await res.json();\n        setHealthData(data);\n        setOllamaStatus(\"online\");\n      } else {\n        setOllamaStatus(\"offline\");\n        setHealthData(null);\n      }\n    } catch {\n      setOllamaStatus(\"offline\");\n      setHealthData(null);\n    }\n  }, []);\n\n  useEffect(() => {\n    checkHealth();\n    const interval = setInterval(checkHealth, 15000);\n    return () => clearInterval(interval);\n  }, [checkHealth]);\n\n  const statusColor =\n    ollamaStatus === \"online\"\n      ? \"bg-emerald-400\"\n      : ollamaStatus === \"checking\"\n      ? \"bg-amber-400\"\n      : \"bg-red-400\";\n\n  const statusLabel =\n    ollamaStatus === \"online\"\n      ? \"Online\"\n      : ollamaStatus === \"checking\"\n      ? \"Connecting‚Ä¶\"\n      : \"Offline\";\n\n  const modeLabel: Record<string, string> = {\n    chat: \"üí¨ Chat\",\n    research: \"üîç Research\",\n    code: \"üíª Code\",\n    image: \"üñºÔ∏è Vision\",\n  };\n\n  const activeModel =\n    smartRoutingEnabled\n      ? healthData?.routing_model || \"auto\"\n      : selectedModel;\n\n  return (\n    <div className=\"shrink-0 flex items-center justify-between gap-3 border-t border-slate-900/60 bg-slate-950/80 px-4 py-1.5 text-[10px] backdrop-blur\">\n      {/* Left: Ollama health */}\n      <div className=\"flex items-center gap-3\">\n        <span className=\"flex items-center gap-1.5\">\n          <span\n            className={`h-1.5 w-1.5 rounded-full ${statusColor} ${\n              ollamaStatus === \"online\" ? \"animate-pulse-glow\" : \"\"\n            }`}\n          />\n          <span className=\"text-slate-400\">Ollama: </span>\n          <span\n            className={\n              ollamaStatus === \"online\"\n                ? \"text-emerald-400\"\n                : ollamaStatus === \"checking\"\n                ? \"text-amber-400\"\n                : \"text-red-400\"\n            }\n          >\n            {statusLabel}\n          </span>\n        </span>\n\n        {healthData && (\n          <span className=\"hidden items-center gap-1 sm:flex\">\n            <span className=\"text-slate-600\">‚Ä¢</span>\n            <span className=\"text-slate-500\">{healthData.models_available} models</span>\n          </span>\n        )}\n      </div>\n\n      {/* Center: Active model */}\n      <div className=\"flex items-center gap-1.5\">\n        <span className=\"text-slate-600\">Model:</span>\n        <span className=\"font-mono text-cyan-400/80 truncate max-w-[140px]\">\n          {activeModel}\n        </span>\n        {smartRoutingEnabled && (\n          <span className=\"rounded bg-cyan-500/10 px-1 text-[9px] font-semibold text-cyan-500 ring-1 ring-cyan-500/20\">\n            AUTO\n          </span>\n        )}\n      </div>\n\n      {/* Right: Routing mode + App mode */}\n      <div className=\"hidden items-center gap-3 sm:flex\">\n        <span className=\"flex items-center gap-1.5\">\n          <span className=\"text-slate-600\">Mode:</span>\n          <span className=\"text-slate-300\">{modeLabel[appMode] ?? appMode}</span>\n        </span>\n        <span className=\"flex items-center gap-1.5\">\n          <span className=\"text-slate-600\">Routing:</span>\n          <span className={smartRoutingEnabled ? \"text-cyan-400\" : \"text-slate-400\"}>\n            {smartRoutingEnabled ? \"Smart\" : \"Manual\"}\n          </span>\n        </span>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMA,MAAM,WACJ,AAAC,OAAO,YAAY,eAAe,QAAQ,GAAG,CAAC,oBAAoB,IACnE;AAWa,SAAS;IACtB,MAAM,gBAAgB,IAAA,wJAAY,EAAC,CAAC,IAAM,EAAE,aAAa;IACzD,MAAM,sBAAsB,IAAA,wJAAY,EAAC,CAAC,IAAM,EAAE,mBAAmB;IACrE,MAAM,UAAU,IAAA,sJAAW,EAAC,CAAC,IAAM,EAAE,IAAI;IAEzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,6NAAQ,EAAe;IAC/D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6NAAQ,EAAoB;IAEhE,MAAM,cAAc,IAAA,gOAAW,EAAC;QAC9B,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,gCAAgC;gBAAE,OAAO;YAAW;YAC5E,IAAI,IAAI,EAAE,EAAE;gBACV,MAAM,OAAmB,MAAM,IAAI,IAAI;gBACvC,cAAc;gBACd,gBAAgB;YAClB,OAAO;gBACL,gBAAgB;gBAChB,cAAc;YAChB;QACF,EAAE,OAAM;YACN,gBAAgB;YAChB,cAAc;QAChB;IACF,GAAG,EAAE;IAEL,IAAA,8NAAS,EAAC;QACR;QACA,MAAM,WAAW,YAAY,aAAa;QAC1C,OAAO,IAAM,cAAc;IAC7B,GAAG;QAAC;KAAY;IAEhB,MAAM,cACJ,iBAAiB,WACb,mBACA,iBAAiB,aACjB,iBACA;IAEN,MAAM,cACJ,iBAAiB,WACb,WACA,iBAAiB,aACjB,gBACA;IAEN,MAAM,YAAoC;QACxC,MAAM;QACN,UAAU;QACV,MAAM;QACN,OAAO;IACT;IAEA,MAAM,cACJ,sBACI,YAAY,iBAAiB,SAC7B;IAEN,qBACE,0PAAC;QAAI,WAAU;;0BAEb,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAK,WAAU;;0CACd,0PAAC;gCACC,WAAW,CAAC,yBAAyB,EAAE,YAAY,CAAC,EAClD,iBAAiB,WAAW,uBAAuB,IACnD;;;;;;0CAEJ,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;0CACjC,0PAAC;gCACC,WACE,iBAAiB,WACb,qBACA,iBAAiB,aACjB,mBACA;0CAGL;;;;;;;;;;;;oBAIJ,4BACC,0PAAC;wBAAK,WAAU;;0CACd,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;0CACjC,0PAAC;gCAAK,WAAU;;oCAAkB,WAAW,gBAAgB;oCAAC;;;;;;;;;;;;;;;;;;;0BAMpE,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAK,WAAU;kCAAiB;;;;;;kCACjC,0PAAC;wBAAK,WAAU;kCACb;;;;;;oBAEF,qCACC,0PAAC;wBAAK,WAAU;kCAA6F;;;;;;;;;;;;0BAOjH,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAK,WAAU;;0CACd,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;0CACjC,0PAAC;gCAAK,WAAU;0CAAkB,SAAS,CAAC,QAAQ,IAAI;;;;;;;;;;;;kCAE1D,0PAAC;wBAAK,WAAU;;0CACd,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;0CACjC,0PAAC;gCAAK,WAAW,sBAAsB,kBAAkB;0CACtD,sBAAsB,UAAU;;;;;;;;;;;;;;;;;;;;;;;;AAM7C"}},
    {"offset": {"line": 1149, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/layout/AppShell.tsx"],"sourcesContent":["\"use client\";\n\nimport { ReactNode, useState } from \"react\";\nimport Header from \"./Header\";\nimport Sidebar from \"./Sidebar\";\nimport StatusBar from \"./StatusBar\";\n\ntype AppShellProps = {\n  children: ReactNode;\n};\n\nexport default function AppShell({ children }: AppShellProps) {\n  const [sidebarOpen, setSidebarOpen] = useState(false);\n\n  return (\n    <div className=\"flex h-full overflow-hidden bg-slate-950 text-slate-100\">\n      {/* Desktop Sidebar */}\n      <div className=\"hidden md:block\">\n        <Sidebar />\n      </div>\n\n      {/* Mobile Sidebar Overlay */}\n      {sidebarOpen && (\n        <div\n          className=\"fixed inset-0 z-40 bg-black/50 backdrop-blur-sm md:hidden\"\n          onClick={() => setSidebarOpen(false)}\n        />\n      )}\n\n      {/* Mobile Sidebar Drawer */}\n      <div\n        className={`fixed inset-y-0 left-0 z-50 w-[260px] transform transition-transform duration-300 ease-in-out md:hidden ${\n          sidebarOpen ? \"translate-x-0\" : \"-translate-x-full\"\n        }`}\n        aria-hidden={!sidebarOpen}\n      >\n        <Sidebar onClose={() => setSidebarOpen(false)} />\n      </div>\n\n      {/* Main content column */}\n      <div className=\"flex flex-1 flex-col overflow-hidden border-l border-slate-900/60 bg-slate-950/80\">\n        <Header onMenuClick={() => setSidebarOpen(!sidebarOpen)} />\n\n        <main className=\"flex-1 overflow-hidden px-4 pb-2 sm:px-6 lg:px-8\">\n          {children}\n        </main>\n\n        <StatusBar />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAWe,SAAS,SAAS,EAAE,QAAQ,EAAiB;IAC1D,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6NAAQ,EAAC;IAE/C,qBACE,0PAAC;QAAI,WAAU;;0BAEb,0PAAC;gBAAI,WAAU;0BACb,cAAA,0PAAC,8JAAO;;;;;;;;;;YAIT,6BACC,0PAAC;gBACC,WAAU;gBACV,SAAS,IAAM,eAAe;;;;;;0BAKlC,0PAAC;gBACC,WAAW,CAAC,wGAAwG,EAClH,cAAc,kBAAkB,qBAChC;gBACF,eAAa,CAAC;0BAEd,cAAA,0PAAC,8JAAO;oBAAC,SAAS,IAAM,eAAe;;;;;;;;;;;0BAIzC,0PAAC;gBAAI,WAAU;;kCACb,0PAAC,6JAAM;wBAAC,aAAa,IAAM,eAAe,CAAC;;;;;;kCAE3C,0PAAC;wBAAK,WAAU;kCACb;;;;;;kCAGH,0PAAC,gKAAS;;;;;;;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 1244, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/lib/api/chat.ts"],"sourcesContent":["export type SearchResult = {\n  title: string;\n  url: string;\n  snippet: string;\n  source: string;\n};\n\ntype StreamEvent =\n  | { type: \"routing\"; payload: Record<string, any> }\n  | { type: \"search_start\"; payload: { query: string; reason?: string } }\n  | { type: \"search_results\"; payload: { results: SearchResult[]; count: number } }\n  | { type: \"search_error\"; payload: { error: string } }\n  | { type: \"delta\"; text: string }\n  | { type: \"done\"; payload: { success: boolean; model_used?: string | null; error?: string | null; web_search_used?: boolean; sources?: string[] } };\n\nexport type StreamCallback = {\n  onRouting?: (payload: Record<string, any>) => void;\n  onSearchStart?: (payload: { query: string; reason?: string }) => void;\n  onSearchResults?: (payload: { results: SearchResult[]; count: number }) => void;\n  onSearchError?: (error: string) => void;\n  onDelta?: (chunk: string) => void;\n  onDone?: (payload: { success: boolean; model_used?: string | null; error?: string | null; web_search_used?: boolean; sources?: string[] }) => void;\n  onError?: (error: string) => void;\n};\n\nconst API_BASE =\n  (typeof process !== \"undefined\" && process.env.NEXT_PUBLIC_API_BASE) ||\n  \"http://localhost:8001/api\";\n\nexport async function streamChat(\n  messages: { role: string; content: string; images?: string[] }[],\n  options: {\n    model?: string;\n    temperature?: number;\n    top_p?: number;\n    max_tokens?: number;\n    signal?: AbortSignal;\n    images?: string[];\n  },\n  callbacks: StreamCallback\n) {\n  console.debug(\"streamChat start\", { api: `${API_BASE}/chat/stream`, messagesCount: messages.length });\n\n  // Add images to the last user message if provided\n  const messagesWithImages = [...messages];\n  if (options.images && options.images.length > 0 && messagesWithImages.length > 0) {\n    const lastMessage = messagesWithImages[messagesWithImages.length - 1];\n    if (lastMessage.role === \"user\") {\n      lastMessage.images = options.images;\n    }\n  }\n\n  const payload = {\n    messages: messagesWithImages,\n    model: options.model ?? \"auto\",\n    temperature: options.temperature ?? 0.7,\n    top_p: options.top_p ?? 0.9,\n    max_tokens: options.max_tokens ?? 2048,\n  };\n\n  const response = await fetch(`${API_BASE}/chat/stream`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(payload),\n    signal: options.signal,\n  });\n\n  if (!response.ok) {\n    const text = await response.text();\n    const msg = text || `Chat request failed (${response.status})`;\n    console.error(\"streamChat http error\", response.status, msg);\n    callbacks.onError?.(msg);\n    throw new Error(msg);\n  }\n\n  const reader = response.body?.getReader();\n  if (!reader) {\n    const msg = \"Failed to read response stream\";\n    console.error(\"streamChat no reader\");\n    callbacks.onError?.(msg);\n    throw new Error(msg);\n  }\n\n  const decoder = new TextDecoder();\n  let buffer = \"\";\n  while (true) {\n    const { value, done } = await reader.read();\n    if (done) break;\n    buffer += decoder.decode(value, { stream: true });\n    const events = buffer.split(\"\\n\\n\");\n    buffer = events.pop() ?? \"\";\n    for (const event of events) {\n      const trimmed = event.trim();\n      if (!trimmed || !trimmed.startsWith(\"data:\")) continue;\n      try {\n        const parsed = JSON.parse(trimmed.replace(/^data:\\s*/, \"\"));\n        handleStreamEvent(parsed as StreamEvent, callbacks);\n      } catch (err) {\n        // ignore malformed chunks\n      }\n    }\n  }\n\n  if (buffer.trim()) {\n    try {\n      const parsed = JSON.parse(buffer.replace(/^data:\\s*/, \"\"));\n      handleStreamEvent(parsed as StreamEvent, callbacks);\n    } catch (err) {\n      // ignore\n    }\n  }\n}\n\nfunction handleStreamEvent(event: StreamEvent, callbacks: StreamCallback) {\n  switch (event.type) {\n    case \"routing\":\n      callbacks.onRouting?.(event.payload);\n      break;\n    case \"search_start\":\n      callbacks.onSearchStart?.(event.payload);\n      break;\n    case \"search_results\":\n      callbacks.onSearchResults?.(event.payload);\n      break;\n    case \"search_error\":\n      callbacks.onSearchError?.(event.payload.error);\n      break;\n    case \"delta\":\n      callbacks.onDelta?.(event.text);\n      break;\n    case \"done\":\n      callbacks.onDone?.(event.payload);\n      break;\n  }\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1349, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/lib/api/research.ts"],"sourcesContent":["type ResearchEvent =\n  | { type: \"question\"; data: { questions: string; content?: string } }\n  | { type: \"progress\"; data: { step?: number; total?: number; message: string } }\n  | { type: \"finding\"; data: { title: string; url: string; snippet: string } }\n  | { type: \"report\"; data: { content: string } }\n  | { type: \"sources\"; data: { sources: string[] } }\n  | { type: \"done\"; data: { success: boolean; key_findings?: string[]; sources?: string[]; phase?: string } }\n  | { type: \"error\"; data: { error: string } };\n\nexport type ResearchCallback = {\n  onQuestion?: (questions: string) => void;\n  onProgress?: (step: number, total: number, message: string) => void;\n  onFinding?: (finding: { title: string; url: string; snippet: string }) => void;\n  onReport?: (chunk: string) => void;\n  onSources?: (sources: string[]) => void;\n  onDone?: (data: { success: boolean; key_findings?: string[]; sources?: string[]; phase?: string }) => void;\n  onError?: (error: string) => void;\n};\n\nconst API_BASE =\n  (typeof process !== \"undefined\" && process.env.NEXT_PUBLIC_API_BASE) ||\n  \"http://localhost:8001/api\";\n\nexport async function streamResearch(\n  query: string,\n  history: Array<{ role: string; content: string }> = [],\n  options: {\n    signal?: AbortSignal;\n  },\n  callbacks: ResearchCallback\n) {\n  console.debug(\"streamResearch start\", { api: `${API_BASE}/agents/research/stream`, query });\n\n  const payload = {\n    query,\n    history,\n    web: true,\n  };\n\n  const response = await fetch(`${API_BASE}/agents/research/stream`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(payload),\n    signal: options.signal,\n  });\n\n  if (!response.ok) {\n    const text = await response.text();\n    const msg = text || `Research request failed (${response.status})`;\n    console.error(\"streamResearch http error\", response.status, msg);\n    callbacks.onError?.(msg);\n    throw new Error(msg);\n  }\n\n  const reader = response.body?.getReader();\n  if (!reader) {\n    const msg = \"Failed to read response stream\";\n    console.error(\"streamResearch no reader\");\n    callbacks.onError?.(msg);\n    throw new Error(msg);\n  }\n\n  const decoder = new TextDecoder();\n  let buffer = \"\";\n\n  try {\n    while (true) {\n      const { value, done } = await reader.read();\n      if (done) {\n        console.debug(\"Research stream ended\");\n        break;\n      }\n\n      buffer += decoder.decode(value, { stream: true });\n      const lines = buffer.split(\"\\n\");\n      buffer = lines.pop() ?? \"\";\n\n      for (const line of lines) {\n        const trimmed = line.trim();\n        if (!trimmed || !trimmed.startsWith(\"data:\")) continue;\n\n        try {\n          const jsonStr = trimmed.replace(/^data:\\s*/, \"\");\n          const parsed = JSON.parse(jsonStr);\n          console.debug(\"Research event parsed:\", parsed.type, parsed.data);\n          handleResearchEvent(parsed as ResearchEvent, callbacks);\n        } catch (err) {\n          // Ignore malformed chunks\n          console.debug(\"Failed to parse research event\", err, trimmed);\n        }\n      }\n    }\n  } catch (error) {\n    console.error(\"Research stream error:\", error);\n    callbacks.onError?.(error instanceof Error ? error.message : String(error));\n    throw error;\n  }\n\n  // Process remaining buffer\n  if (buffer.trim()) {\n    try {\n      const parsed = JSON.parse(buffer.replace(/^data:\\s*/, \"\"));\n      handleResearchEvent(parsed as ResearchEvent, callbacks);\n    } catch (err) {\n      // Ignore\n    }\n  }\n}\n\nfunction handleResearchEvent(event: ResearchEvent, callbacks: ResearchCallback) {\n  console.debug(\"Research event received:\", event.type, event.data);\n  switch (event.type) {\n    case \"question\":\n      const questionText = event.data.questions || event.data.content || \"\";\n      console.debug(\"Question text:\", questionText);\n      callbacks.onQuestion?.(questionText);\n      break;\n    case \"progress\":\n      callbacks.onProgress?.(\n        event.data.step || 0,\n        event.data.total || 0,\n        event.data.message || \"\"\n      );\n      break;\n    case \"finding\":\n      callbacks.onFinding?.(event.data);\n      break;\n    case \"report\":\n      callbacks.onReport?.(event.data.content || \"\");\n      break;\n    case \"sources\":\n      callbacks.onSources?.(event.data.sources || []);\n      break;\n    case \"done\":\n      callbacks.onDone?.(event.data);\n      break;\n    case \"error\":\n      callbacks.onError?.(event.data.error || \"Unknown error\");\n      break;\n  }\n}\n\nexport async function chatResearch(\n  query: string,\n  history: Array<{ role: string; content: string }> = [],\n  options?: {\n    signal?: AbortSignal;\n  }\n) {\n  console.debug(\"chatResearch start\", { api: `${API_BASE}/agents/research`, query });\n\n  const payload = {\n    query,\n    history,\n    web: true,\n  };\n\n  const response = await fetch(`${API_BASE}/agents/research`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify(payload),\n    signal: options?.signal,\n  });\n\n  if (!response.ok) {\n    const text = await response.text();\n    throw new Error(text || `Research request failed (${response.status})`);\n  }\n\n  return response.json();\n}\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1487, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/RoutingInfoPanel.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport type { RoutingInfo } from \"./types\";\r\n\r\ntype RoutingInfoPanelProps = {\r\n  info: RoutingInfo;\r\n  previousModel?: string | null;\r\n};\r\n\r\nexport default function RoutingInfoPanel({ info, previousModel }: RoutingInfoPanelProps) {\r\n  const packing = info.packing;\r\n  const modelMeta = info.model_meta;\r\n  const isModelSwitch = previousModel && previousModel !== info.model;\r\n\r\n  return (\r\n    <div className=\"mb-3 rounded-2xl border border-slate-900/70 bg-slate-900/60 px-4 py-3 text-sm text-slate-200 shadow-inner shadow-slate-950/30\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <p className=\"text-xs uppercase tracking-[0.18em] text-slate-400\">Routing</p>\r\n        <span className=\"text-[10px] text-slate-500\">\r\n          {info.processing_time_ms ?? 0}ms\r\n        </span>\r\n      </div>\r\n      <div className=\"mt-2 flex flex-wrap items-center gap-2\">\r\n        <span className=\"rounded-full bg-slate-800 px-2 py-0.5 text-[11px] font-semibold text-slate-200\">\r\n          {info.model}\r\n        </span>\r\n        <span className={`rounded-full px-2 py-0.5 text-[11px] ${\r\n          info.routing_method === \"llm\" \r\n            ? \"bg-cyan-500/20 text-cyan-300\" \r\n            : info.routing_method === \"cached\"\r\n            ? \"bg-purple-500/20 text-purple-300\"\r\n            : \"bg-slate-800 text-slate-400\"\r\n        }`}>\r\n          {info.routing_method === \"llm\" ? \"LLM routed\" : \r\n           info.routing_method === \"cached\" ? \"Cached\" :\r\n           info.routing_method === \"manual_override\" ? \"Manual\" : \"Regex\"}\r\n        </span>\r\n        {info.task_type && (\r\n          <span className=\"rounded-full bg-slate-800 px-2 py-0.5 text-[11px] text-slate-400\">\r\n            {info.task_type}\r\n          </span>\r\n        )}\r\n        {typeof info.confidence === \"number\" && (\r\n          <span className=\"rounded-full bg-slate-800 px-2 py-0.5 text-[11px] text-slate-400\">\r\n            Confidence {(info.confidence * 100).toFixed(0)}%\r\n          </span>\r\n        )}\r\n      </div>\r\n      {info.reasoning && (\r\n        <p className=\"mt-2 text-xs text-slate-400 line-clamp-2\">{info.reasoning}</p>\r\n      )}\r\n      {info.warning && (\r\n        <p className=\"mt-1 text-[10px] text-amber-400\">{info.warning}</p>\r\n      )}\r\n      {info.classification_details?.reasoning && (\r\n        <p className=\"mt-1 text-[10px] text-slate-500\">\r\n          {info.classification_details.reasoning}\r\n        </p>\r\n      )}\r\n      {packing && (\r\n        <div className=\"mt-2 grid grid-cols-2 gap-2 text-[11px] text-slate-400 sm:grid-cols-3\">\r\n          <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n            <span className=\"text-slate-500\">Kept</span> {packing.tokens_kept ?? 0}\r\n          </div>\r\n          <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n            <span className=\"text-slate-500\">Dropped</span> {packing.tokens_dropped ?? 0}\r\n          </div>\r\n          <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n            <span className=\"text-slate-500\">Window</span> {packing.context_window ?? \"?\"}\r\n          </div>\r\n          {packing.used_summary && (\r\n            <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n              <span className=\"text-slate-500\">Summary</span> {packing.summary_tokens ?? 0} tok\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      {modelMeta && (\r\n        <div className=\"mt-2 grid grid-cols-2 gap-2 text-[11px] text-slate-400 sm:grid-cols-3\">\r\n          {typeof modelMeta.estimated_vram_gb !== \"undefined\" && (\r\n            <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n              <span className=\"text-slate-500\">VRAM</span> ~{modelMeta.estimated_vram_gb} GB\r\n            </div>\r\n          )}\r\n          {typeof modelMeta.context_window !== \"undefined\" && (\r\n            <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n              <span className=\"text-slate-500\">Ctx</span> {modelMeta.context_window}\r\n            </div>\r\n          )}\r\n          {typeof modelMeta.estimated_tokens_per_sec !== \"undefined\" && (\r\n            <div className=\"rounded bg-slate-900/70 px-2 py-1\">\r\n              <span className=\"text-slate-500\">Speed</span> {modelMeta.estimated_tokens_per_sec} t/s\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      {isModelSwitch && (\r\n        <p className=\"mt-2 text-[11px] text-amber-300\">\r\n          Model switched from {previousModel} ‚Üí {info.model}\r\n        </p>\r\n      )}\r\n      {!isModelSwitch && previousModel && (\r\n        <p className=\"mt-2 text-[11px] text-slate-500\">Model steady: {info.model}</p>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":";;;;;AAAA;;AASe,SAAS,iBAAiB,EAAE,IAAI,EAAE,aAAa,EAAyB;IACrF,MAAM,UAAU,KAAK,OAAO;IAC5B,MAAM,YAAY,KAAK,UAAU;IACjC,MAAM,gBAAgB,iBAAiB,kBAAkB,KAAK,KAAK;IAEnE,qBACE,0PAAC;QAAI,WAAU;;0BACb,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAE,WAAU;kCAAqD;;;;;;kCAClE,0PAAC;wBAAK,WAAU;;4BACb,KAAK,kBAAkB,IAAI;4BAAE;;;;;;;;;;;;;0BAGlC,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAK,WAAU;kCACb,KAAK,KAAK;;;;;;kCAEb,0PAAC;wBAAK,WAAW,CAAC,qCAAqC,EACrD,KAAK,cAAc,KAAK,QACpB,iCACA,KAAK,cAAc,KAAK,WACxB,qCACA,+BACJ;kCACC,KAAK,cAAc,KAAK,QAAQ,eAChC,KAAK,cAAc,KAAK,WAAW,WACnC,KAAK,cAAc,KAAK,oBAAoB,WAAW;;;;;;oBAEzD,KAAK,SAAS,kBACb,0PAAC;wBAAK,WAAU;kCACb,KAAK,SAAS;;;;;;oBAGlB,OAAO,KAAK,UAAU,KAAK,0BAC1B,0PAAC;wBAAK,WAAU;;4BAAmE;4BACrE,CAAC,KAAK,UAAU,GAAG,GAAG,EAAE,OAAO,CAAC;4BAAG;;;;;;;;;;;;;YAIpD,KAAK,SAAS,kBACb,0PAAC;gBAAE,WAAU;0BAA4C,KAAK,SAAS;;;;;;YAExE,KAAK,OAAO,kBACX,0PAAC;gBAAE,WAAU;0BAAmC,KAAK,OAAO;;;;;;YAE7D,KAAK,sBAAsB,EAAE,2BAC5B,0PAAC;gBAAE,WAAU;0BACV,KAAK,sBAAsB,CAAC,SAAS;;;;;;YAGzC,yBACC,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAW;4BAAE,QAAQ,WAAW,IAAI;;;;;;;kCAEvE,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAc;4BAAE,QAAQ,cAAc,IAAI;;;;;;;kCAE7E,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAa;4BAAE,QAAQ,cAAc,IAAI;;;;;;;oBAE3E,QAAQ,YAAY,kBACnB,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAc;4BAAE,QAAQ,cAAc,IAAI;4BAAE;;;;;;;;;;;;;YAKpF,2BACC,0PAAC;gBAAI,WAAU;;oBACZ,OAAO,UAAU,iBAAiB,KAAK,6BACtC,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAW;4BAAG,UAAU,iBAAiB;4BAAC;;;;;;;oBAG9E,OAAO,UAAU,cAAc,KAAK,6BACnC,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAU;4BAAE,UAAU,cAAc;;;;;;;oBAGxE,OAAO,UAAU,wBAAwB,KAAK,6BAC7C,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;0CAAiB;;;;;;4BAAY;4BAAE,UAAU,wBAAwB;4BAAC;;;;;;;;;;;;;YAKzF,+BACC,0PAAC;gBAAE,WAAU;;oBAAkC;oBACxB;oBAAc;oBAAI,KAAK,KAAK;;;;;;;YAGpD,CAAC,iBAAiB,+BACjB,0PAAC;gBAAE,WAAU;;oBAAkC;oBAAe,KAAK,KAAK;;;;;;;;;;;;;AAIhF"}},
    {"offset": {"line": 1787, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/layout/ChatHeader.tsx"],"sourcesContent":["\"use client\";\n\nimport RoutingInfoPanel from \"../RoutingInfoPanel\";\nimport type { RoutingInfo } from \"../types\";\n\ntype ChatHeaderProps = {\n  routingInfo: RoutingInfo | null;\n  currentModel: string | null;\n  showRouting: boolean;\n  onToggleRouting: () => void;\n  offline: boolean;\n  appMode: string;\n};\n\nexport default function ChatHeader({\n  routingInfo,\n  currentModel,\n  showRouting,\n  onToggleRouting,\n  offline,\n  appMode,\n}: ChatHeaderProps) {\n  return (\n    <>\n      {routingInfo && (\n        <div className=\"flex items-center justify-between rounded-xl border border-slate-900/70 bg-slate-900/70 px-3 py-2 text-sm text-slate-200\">\n          <div className=\"flex items-center gap-2 text-xs text-slate-400\">\n            <span className=\"h-2 w-2 rounded-full bg-cyan-400\" />\n            Routing info available (model: {routingInfo.model})\n          </div>\n          <button\n            onClick={onToggleRouting}\n            className=\"rounded-lg border border-slate-800 px-3 py-1 text-xs font-semibold text-slate-100 transition hover:border-cyan-500 hover:text-cyan-300\"\n          >\n            {showRouting ? \"Hide\" : \"Show\"} routing\n          </button>\n        </div>\n      )}\n\n      {showRouting && routingInfo && (\n        <div className=\"rounded-2xl border border-slate-900/70 bg-slate-900/60 px-4 py-3 shadow-inner shadow-slate-950/30\">\n          <RoutingInfoPanel info={routingInfo} previousModel={currentModel} />\n        </div>\n      )}\n\n      {offline && (\n        <div className=\"flex items-center gap-2 rounded-xl border border-amber-500/40 bg-amber-500/10 px-3 py-2 text-xs text-amber-200\">\n          <span className=\"h-2 w-2 rounded-full bg-amber-400\" />\n          Offline detected. Sending is disabled until you reconnect.\n        </div>\n      )}\n\n      {appMode !== \"chat\" && (\n        <div className=\"flex items-center gap-2 rounded-xl border border-cyan-500/30 bg-cyan-500/5 px-3 py-2 text-xs text-cyan-300 animate-in fade-in slide-in-from-top-2 duration-300\">\n          <span className=\"h-2 w-2 rounded-full bg-cyan-400 animate-pulse\" />\n          <span className=\"font-semibold capitalize\">{appMode}</span>\n          <span className=\"text-cyan-400/70\">mode active</span>\n        </div>\n      )}\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAce,SAAS,WAAW,EACjC,WAAW,EACX,YAAY,EACZ,WAAW,EACX,eAAe,EACf,OAAO,EACP,OAAO,EACS;IAChB,qBACE;;YACG,6BACC,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAK,WAAU;;;;;;4BAAqC;4BACrB,YAAY,KAAK;4BAAC;;;;;;;kCAEpD,0PAAC;wBACC,SAAS;wBACT,WAAU;;4BAET,cAAc,SAAS;4BAAO;;;;;;;;;;;;;YAKpC,eAAe,6BACd,0PAAC;gBAAI,WAAU;0BACb,cAAA,0PAAC,qKAAgB;oBAAC,MAAM;oBAAa,eAAe;;;;;;;;;;;YAIvD,yBACC,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAK,WAAU;;;;;;oBAAsC;;;;;;;YAKzD,YAAY,wBACX,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAK,WAAU;;;;;;kCAChB,0PAAC;wBAAK,WAAU;kCAA4B;;;;;;kCAC5C,0PAAC;wBAAK,WAAU;kCAAmB;;;;;;;;;;;;;;AAK7C"}},
    {"offset": {"line": 1973, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/MarkdownRenderer.tsx"],"sourcesContent":["\"use client\";\n\nimport ReactMarkdown from \"react-markdown\";\nimport remarkGfm from \"remark-gfm\";\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\";\nimport { oneDark } from \"react-syntax-highlighter/dist/esm/styles/prism\";\nimport { useState } from \"react\";\n\ntype MarkdownRendererProps = {\n  content: string;\n};\n\nfunction CopyButton({ text }: { text: string }) {\n  const [copied, setCopied] = useState(false);\n\n  const handleCopy = async () => {\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch {\n      // fallback\n    }\n  };\n\n  return (\n    <button\n      onClick={handleCopy}\n      className=\"rounded bg-slate-700/60 px-2 py-0.5 text-[10px] font-medium text-slate-300 transition hover:bg-slate-600/80 hover:text-white\"\n      aria-label=\"Copy code\"\n    >\n      {copied ? \"‚úì Copied\" : \"Copy\"}\n    </button>\n  );\n}\n\nexport default function MarkdownRenderer({ content }: MarkdownRendererProps) {\n  return (\n    <div className=\"markdown-content max-w-none\">\n      <ReactMarkdown\n        remarkPlugins={[remarkGfm]}\n        components={{\n          // Headings\n          h1: ({ node, ...props }) => (\n            <h1\n              className=\"mb-4 mt-6 border-b border-slate-700/50 pb-2 text-2xl font-bold text-slate-100\"\n              {...props}\n            />\n          ),\n          h2: ({ node, ...props }) => (\n            <h2\n              className=\"mb-3 mt-5 text-xl font-bold text-slate-100\"\n              {...props}\n            />\n          ),\n          h3: ({ node, ...props }) => (\n            <h3\n              className=\"mb-2 mt-4 text-lg font-semibold text-slate-200\"\n              {...props}\n            />\n          ),\n          h4: ({ node, ...props }) => (\n            <h4\n              className=\"mb-2 mt-3 text-base font-semibold text-slate-200\"\n              {...props}\n            />\n          ),\n          // Paragraphs\n          p: ({ node, ...props }) => (\n            <p className=\"mb-3 leading-relaxed text-slate-200\" {...props} />\n          ),\n          // Lists\n          ul: ({ node, ...props }) => (\n            <ul\n              className=\"mb-3 ml-5 list-disc space-y-1 text-slate-200\"\n              {...props}\n            />\n          ),\n          ol: ({ node, ...props }) => (\n            <ol\n              className=\"mb-3 ml-5 list-decimal space-y-1 text-slate-200\"\n              {...props}\n            />\n          ),\n          li: ({ node, ...props }) => (\n            <li className=\"text-slate-200 leading-relaxed\" {...props} />\n          ),\n          // Code ‚Äî handles both inline and block\n          code: ({ node, className, children, ...props }: any) => {\n            const match = /language-(\\w+)/.exec(className || \"\");\n\n            // Inline code\n            if (!match) {\n              return (\n                <code\n                  className=\"rounded bg-slate-800 px-1.5 py-0.5 text-[0.8em] font-mono text-cyan-300 ring-1 ring-slate-700/50\"\n                  {...props}\n                >\n                  {children}\n                </code>\n              );\n            }\n\n            // Block code with syntax highlighting\n            const codeString = String(children).replace(/\\n$/, \"\");\n            const language = match[1];\n\n            return (\n              <div className=\"mb-4 overflow-hidden rounded-xl border border-slate-700/50 shadow-lg shadow-slate-950/50\">\n                {/* Header bar */}\n                <div className=\"flex items-center justify-between bg-slate-800/80 px-4 py-2 border-b border-slate-700/50\">\n                  <div className=\"flex items-center gap-2\">\n                    <span className=\"flex gap-1.5\">\n                      <span className=\"h-2.5 w-2.5 rounded-full bg-red-500/70\" />\n                      <span className=\"h-2.5 w-2.5 rounded-full bg-yellow-500/70\" />\n                      <span className=\"h-2.5 w-2.5 rounded-full bg-green-500/70\" />\n                    </span>\n                    <span className=\"text-[10px] font-mono uppercase tracking-wider text-slate-400\">\n                      {language}\n                    </span>\n                  </div>\n                  <CopyButton text={codeString} />\n                </div>\n                {/* Code body */}\n                <SyntaxHighlighter\n                  style={oneDark}\n                  language={language}\n                  PreTag=\"div\"\n                  showLineNumbers={codeString.split(\"\\n\").length > 5}\n                  customStyle={{\n                    margin: 0,\n                    borderRadius: 0,\n                    background: \"#0d1117\",\n                    fontSize: \"0.8rem\",\n                    lineHeight: \"1.65\",\n                    padding: \"1rem\",\n                  }}\n                  lineNumberStyle={{\n                    color: \"#4b5563\",\n                    minWidth: \"2.5em\",\n                    paddingRight: \"1em\",\n                    userSelect: \"none\",\n                  }}\n                >\n                  {codeString}\n                </SyntaxHighlighter>\n              </div>\n            );\n          },\n          // Pre ‚Äî just pass through children (code block handles rendering)\n          pre: ({ node, children }) => <>{children}</>,\n          // Links\n          a: ({ node, ...props }) => (\n            <a\n              className=\"text-cyan-400 underline decoration-cyan-400/40 underline-offset-2 transition hover:text-cyan-300 hover:decoration-cyan-300\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              {...props}\n            />\n          ),\n          // Blockquotes\n          blockquote: ({ node, ...props }) => (\n            <blockquote\n              className=\"my-4 border-l-4 border-cyan-500/50 bg-slate-900/50 pl-4 pr-2 py-1 italic text-slate-300 rounded-r\"\n              {...props}\n            />\n          ),\n          // Tables\n          table: ({ node, ...props }) => (\n            <div className=\"my-4 overflow-x-auto rounded-lg border border-slate-700/50\">\n              <table\n                className=\"min-w-full border-collapse\"\n                {...props}\n              />\n            </div>\n          ),\n          thead: ({ node, ...props }) => (\n            <thead className=\"bg-slate-800/80\" {...props} />\n          ),\n          th: ({ node, ...props }) => (\n            <th\n              className=\"border-b border-slate-700 px-4 py-2.5 text-left text-xs font-semibold uppercase tracking-wider text-slate-300\"\n              {...props}\n            />\n          ),\n          td: ({ node, ...props }) => (\n            <td\n              className=\"border-b border-slate-800/70 px-4 py-2.5 text-sm text-slate-200\"\n              {...props}\n            />\n          ),\n          tr: ({ node, ...props }) => (\n            <tr\n              className=\"transition-colors hover:bg-slate-800/30\"\n              {...props}\n            />\n          ),\n          // Horizontal rule\n          hr: ({ node, ...props }) => (\n            <hr className=\"my-6 border-slate-700/60\" {...props} />\n          ),\n          // Strong / em\n          strong: ({ node, ...props }) => (\n            <strong className=\"font-bold text-slate-100\" {...props} />\n          ),\n          em: ({ node, ...props }) => (\n            <em className=\"italic text-slate-300\" {...props} />\n          ),\n        }}\n      >\n        {content}\n      </ReactMarkdown>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAYA,SAAS,WAAW,EAAE,IAAI,EAAoB;IAC5C,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6NAAQ,EAAC;IAErC,MAAM,aAAa;QACjB,IAAI;YACF,MAAM,UAAU,SAAS,CAAC,SAAS,CAAC;YACpC,UAAU;YACV,WAAW,IAAM,UAAU,QAAQ;QACrC,EAAE,OAAM;QACN,WAAW;QACb;IACF;IAEA,qBACE,0PAAC;QACC,SAAS;QACT,WAAU;QACV,cAAW;kBAEV,SAAS,aAAa;;;;;;AAG7B;AAEe,SAAS,iBAAiB,EAAE,OAAO,EAAyB;IACzE,qBACE,0PAAC;QAAI,WAAU;kBACb,cAAA,0PAAC,+MAAa;YACZ,eAAe;gBAAC,oKAAS;aAAC;YAC1B,YAAY;gBACV,WAAW;gBACX,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,aAAa;gBACb,GAAG,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACpB,0PAAC;wBAAE,WAAU;wBAAuC,GAAG,KAAK;;;;;;gBAE9D,QAAQ;gBACR,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBAAG,WAAU;wBAAkC,GAAG,KAAK;;;;;;gBAE1D,uCAAuC;gBACvC,MAAM,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAY;oBACjD,MAAM,QAAQ,iBAAiB,IAAI,CAAC,aAAa;oBAEjD,cAAc;oBACd,IAAI,CAAC,OAAO;wBACV,qBACE,0PAAC;4BACC,WAAU;4BACT,GAAG,KAAK;sCAER;;;;;;oBAGP;oBAEA,sCAAsC;oBACtC,MAAM,aAAa,OAAO,UAAU,OAAO,CAAC,OAAO;oBACnD,MAAM,WAAW,KAAK,CAAC,EAAE;oBAEzB,qBACE,0PAAC;wBAAI,WAAU;;0CAEb,0PAAC;gCAAI,WAAU;;kDACb,0PAAC;wCAAI,WAAU;;0DACb,0PAAC;gDAAK,WAAU;;kEACd,0PAAC;wDAAK,WAAU;;;;;;kEAChB,0PAAC;wDAAK,WAAU;;;;;;kEAChB,0PAAC;wDAAK,WAAU;;;;;;;;;;;;0DAElB,0PAAC;gDAAK,WAAU;0DACb;;;;;;;;;;;;kDAGL,0PAAC;wCAAW,MAAM;;;;;;;;;;;;0CAGpB,0PAAC,+NAAiB;gCAChB,OAAO,4PAAO;gCACd,UAAU;gCACV,QAAO;gCACP,iBAAiB,WAAW,KAAK,CAAC,MAAM,MAAM,GAAG;gCACjD,aAAa;oCACX,QAAQ;oCACR,cAAc;oCACd,YAAY;oCACZ,UAAU;oCACV,YAAY;oCACZ,SAAS;gCACX;gCACA,iBAAiB;oCACf,OAAO;oCACP,UAAU;oCACV,cAAc;oCACd,YAAY;gCACd;0CAEC;;;;;;;;;;;;gBAIT;gBACA,kEAAkE;gBAClE,KAAK,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,iBAAK;kCAAG;;gBAChC,QAAQ;gBACR,GAAG,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACpB,0PAAC;wBACC,WAAU;wBACV,QAAO;wBACP,KAAI;wBACH,GAAG,KAAK;;;;;;gBAGb,cAAc;gBACd,YAAY,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBAC7B,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,SAAS;gBACT,OAAO,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACxB,0PAAC;wBAAI,WAAU;kCACb,cAAA,0PAAC;4BACC,WAAU;4BACT,GAAG,KAAK;;;;;;;;;;;gBAIf,OAAO,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACxB,0PAAC;wBAAM,WAAU;wBAAmB,GAAG,KAAK;;;;;;gBAE9C,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBACC,WAAU;wBACT,GAAG,KAAK;;;;;;gBAGb,kBAAkB;gBAClB,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBAAG,WAAU;wBAA4B,GAAG,KAAK;;;;;;gBAEpD,cAAc;gBACd,QAAQ,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACzB,0PAAC;wBAAO,WAAU;wBAA4B,GAAG,KAAK;;;;;;gBAExD,IAAI,CAAC,EAAE,IAAI,EAAE,GAAG,OAAO,iBACrB,0PAAC;wBAAG,WAAU;wBAAyB,GAAG,KAAK;;;;;;YAEnD;sBAEC;;;;;;;;;;;AAIT"}},
    {"offset": {"line": 2318, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/Feedback.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\ntype FeedbackProps = {\n    messageId: string;\n    onSubmit: (rating: number) => void;\n};\n\nexport default function Feedback({ messageId, onSubmit }: FeedbackProps) {\n    const [rating, setRating] = useState(0);\n    const [submitted, setSubmitted] = useState(false);\n\n    const handleSubmit = () => {\n        if (rating > 0) {\n            onSubmit(rating);\n            setSubmitted(true);\n        }\n    };\n\n    if (submitted) {\n        return <div className=\"text-xs text-slate-500\">Thanks for your feedback!</div>;\n    }\n\n    return (\n        <div className=\"flex items-center gap-2\">\n            <div className=\"text-xs text-slate-500\">Rate this response:</div>\n            <div className=\"flex\">\n                {[1, 2, 3, 4, 5].map((star) => (\n                    <button\n                        key={star}\n                        onClick={() => setRating(star)}\n                        className={`text-lg ${rating >= star ? \"text-yellow-400\" : \"text-slate-600\"}`}\n                    >\n                        ‚òÖ\n                    </button>\n                ))}\n            </div>\n            <button\n                onClick={handleSubmit}\n                disabled={rating === 0}\n                className=\"rounded-lg border border-slate-800 px-3 py-1 text-xs font-semibold text-slate-100 transition hover:border-cyan-500 hover:text-cyan-300 disabled:opacity-50\"\n            >\n                Submit\n            </button>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASe,SAAS,SAAS,EAAE,SAAS,EAAE,QAAQ,EAAiB;IACnE,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6NAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,6NAAQ,EAAC;IAE3C,MAAM,eAAe;QACjB,IAAI,SAAS,GAAG;YACZ,SAAS;YACT,aAAa;QACjB;IACJ;IAEA,IAAI,WAAW;QACX,qBAAO,0PAAC;YAAI,WAAU;sBAAyB;;;;;;IACnD;IAEA,qBACI,0PAAC;QAAI,WAAU;;0BACX,0PAAC;gBAAI,WAAU;0BAAyB;;;;;;0BACxC,0PAAC;gBAAI,WAAU;0BACV;oBAAC;oBAAG;oBAAG;oBAAG;oBAAG;iBAAE,CAAC,GAAG,CAAC,CAAC,qBAClB,0PAAC;wBAEG,SAAS,IAAM,UAAU;wBACzB,WAAW,CAAC,QAAQ,EAAE,UAAU,OAAO,oBAAoB,kBAAkB;kCAChF;uBAHQ;;;;;;;;;;0BAQjB,0PAAC;gBACG,SAAS;gBACT,UAAU,WAAW;gBACrB,WAAU;0BACb;;;;;;;;;;;;AAKb"}},
    {"offset": {"line": 2400, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/MessageBubble.tsx"],"sourcesContent":["\"use client\";\n\nimport MarkdownRenderer from \"./MarkdownRenderer\";\nimport type { Message } from \"./types\";\nimport Feedback from \"./Feedback\";\nimport { useChatStore } from \"@/lib/stores/chat\";\n\ntype MessageBubbleProps = {\n  message: Message;\n  toolMode?: string;\n  modelUsed?: string | null;\n  showMetadata?: boolean;\n};\n\nexport default function MessageBubble({\n  message,\n  toolMode,\n  modelUsed,\n  showMetadata = false,\n}: MessageBubbleProps) {\n  const isUser = message.role === \"user\";\n  const timestamp = message.createdAt\n    ? new Date(message.createdAt).toLocaleTimeString([], { hour: \"2-digit\", minute: \"2-digit\" })\n    : null;\n\n  const handleFeedback = async (rating: number) => {\n    const activeId = useChatStore.getState().activeId;\n    if (!activeId) return;\n\n    const conversation = useChatStore.getState().conversations[activeId];\n    if (!conversation) return;\n\n    // Find the user message that came before this assistant message\n    const messageIndex = conversation.messages.findIndex((m) => m.id === message.id);\n    const userMessage = conversation.messages\n      .slice(0, messageIndex)\n      .reverse()\n      .find((m) => m.role === \"user\");\n\n    if (userMessage) {\n      try {\n        await fetch(\"http://localhost:8001/api/feedback\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            query: userMessage.content,\n            model_used: modelUsed || \"unknown\",\n            rating: rating,\n          }),\n        });\n      } catch (error) {\n        console.error(\"Failed to send feedback\", error);\n      }\n    }\n  };\n\n  return (\n    <div\n      className={`flex ${isUser ? \"justify-end\" : \"justify-start\"} transition-all duration-300`}\n    >\n      <div\n        className={`group relative max-w-[85%] rounded-2xl px-4 py-3 ${\n          isUser\n            ? \"bg-cyan-500/20 text-slate-100\"\n            : message.error\n            ? \"border border-red-500/50 bg-red-500/10 text-red-200\"\n            : \"border border-slate-800 bg-slate-900/80 text-slate-100\"\n        }`}\n      >\n        {/* Header with role and metadata */}\n        <div className=\"mb-1 flex items-center gap-2\">\n          <p className={`text-[10px] font-semibold uppercase tracking-wider ${message.error ? \"text-red-400\" : \"text-slate-500\"}`}>\n            {isUser ? \"You\" : \"Assistant\"}\n          </p>\n          {timestamp && (\n            <span className={`text-[10px] ${message.error ? \"text-red-400/70\" : \"text-slate-600\"}`}>{timestamp}</span>\n          )}\n          {!isUser && toolMode && toolMode !== \"none\" && (\n            <span className=\"rounded-full bg-cyan-500/20 px-1.5 py-0.5 text-[9px] font-semibold text-cyan-300\">\n              {toolMode === \"research\" ? \"üîç Research\" : toolMode === \"reasoning\" ? \"üß† Reasoning\" : toolMode === \"vision\" ? \"üñºÔ∏è Vision\" : toolMode === \"file\" ? \"üìé File\" : \"\"}\n            </span>\n          )}\n          {!isUser && modelUsed && showMetadata && (\n            <span className=\"rounded-full bg-purple-500/20 px-1.5 py-0.5 text-[9px] font-semibold text-purple-300\">\n              {modelUsed}\n            </span>\n          )}\n        </div>\n\n        {/* Attached image preview */}\n        {message.imageUrl && (\n          <div className=\"mb-3\">\n            {/* eslint-disable-next-line @next/next/no-img-element */}\n            <img\n              src={message.imageUrl}\n              alt=\"Attached image\"\n              className=\"max-h-64 max-w-full rounded-lg border border-slate-700/50 object-contain shadow-md\"\n            />\n          </div>\n        )}\n\n        {/* Message content */}\n        <div className=\"text-sm leading-relaxed\">\n          {message.error && (\n            <div className=\"mb-2 flex items-center gap-2 text-xs font-semibold text-red-400\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                <path fillRule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z\" clipRule=\"evenodd\" />\n              </svg>\n              <span>Error</span>\n            </div>\n          )}\n          {isUser ? (\n            <p className=\"whitespace-pre-wrap\">{message.content}</p>\n          ) : (\n            <MarkdownRenderer content={message.content} />\n          )}\n        </div>\n\n        {/* Feedback section */}\n        {!isUser && !message.error && (\n          <div className=\"mt-2 border-t border-slate-800 pt-2\">\n            <Feedback messageId={message.id} onSubmit={handleFeedback} />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AALA;;;;;AAce,SAAS,cAAc,EACpC,OAAO,EACP,QAAQ,EACR,SAAS,EACT,eAAe,KAAK,EACD;IACnB,MAAM,SAAS,QAAQ,IAAI,KAAK;IAChC,MAAM,YAAY,QAAQ,SAAS,GAC/B,IAAI,KAAK,QAAQ,SAAS,EAAE,kBAAkB,CAAC,EAAE,EAAE;QAAE,MAAM;QAAW,QAAQ;IAAU,KACxF;IAEJ,MAAM,iBAAiB,OAAO;QAC5B,MAAM,WAAW,wJAAY,CAAC,QAAQ,GAAG,QAAQ;QACjD,IAAI,CAAC,UAAU;QAEf,MAAM,eAAe,wJAAY,CAAC,QAAQ,GAAG,aAAa,CAAC,SAAS;QACpE,IAAI,CAAC,cAAc;QAEnB,gEAAgE;QAChE,MAAM,eAAe,aAAa,QAAQ,CAAC,SAAS,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK,QAAQ,EAAE;QAC/E,MAAM,cAAc,aAAa,QAAQ,CACtC,KAAK,CAAC,GAAG,cACT,OAAO,GACP,IAAI,CAAC,CAAC,IAAM,EAAE,IAAI,KAAK;QAE1B,IAAI,aAAa;YACf,IAAI;gBACF,MAAM,MAAM,sCAAsC;oBAChD,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBACnB,OAAO,YAAY,OAAO;wBAC1B,YAAY,aAAa;wBACzB,QAAQ;oBACV;gBACF;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2BAA2B;YAC3C;QACF;IACF;IAEA,qBACE,0PAAC;QACC,WAAW,CAAC,KAAK,EAAE,SAAS,gBAAgB,gBAAgB,4BAA4B,CAAC;kBAEzF,cAAA,0PAAC;YACC,WAAW,CAAC,iDAAiD,EAC3D,SACI,kCACA,QAAQ,KAAK,GACb,wDACA,0DACJ;;8BAGF,0PAAC;oBAAI,WAAU;;sCACb,0PAAC;4BAAE,WAAW,CAAC,mDAAmD,EAAE,QAAQ,KAAK,GAAG,iBAAiB,kBAAkB;sCACpH,SAAS,QAAQ;;;;;;wBAEnB,2BACC,0PAAC;4BAAK,WAAW,CAAC,YAAY,EAAE,QAAQ,KAAK,GAAG,oBAAoB,kBAAkB;sCAAG;;;;;;wBAE1F,CAAC,UAAU,YAAY,aAAa,wBACnC,0PAAC;4BAAK,WAAU;sCACb,aAAa,aAAa,gBAAgB,aAAa,cAAc,iBAAiB,aAAa,WAAW,eAAe,aAAa,SAAS,YAAY;;;;;;wBAGnK,CAAC,UAAU,aAAa,8BACvB,0PAAC;4BAAK,WAAU;sCACb;;;;;;;;;;;;gBAMN,QAAQ,QAAQ,kBACf,0PAAC;oBAAI,WAAU;8BAEb,cAAA,0PAAC;wBACC,KAAK,QAAQ,QAAQ;wBACrB,KAAI;wBACJ,WAAU;;;;;;;;;;;8BAMhB,0PAAC;oBAAI,WAAU;;wBACZ,QAAQ,KAAK,kBACZ,0PAAC;4BAAI,WAAU;;8CACb,0PAAC;oCAAI,OAAM;oCAA6B,WAAU;oCAAU,SAAQ;oCAAY,MAAK;8CACnF,cAAA,0PAAC;wCAAK,UAAS;wCAAU,GAAE;wCAAoH,UAAS;;;;;;;;;;;8CAE1J,0PAAC;8CAAK;;;;;;;;;;;;wBAGT,uBACC,0PAAC;4BAAE,WAAU;sCAAuB,QAAQ,OAAO;;;;;iDAEnD,0PAAC,qKAAgB;4BAAC,SAAS,QAAQ,OAAO;;;;;;;;;;;;gBAK7C,CAAC,UAAU,CAAC,QAAQ,KAAK,kBACxB,0PAAC;oBAAI,WAAU;8BACb,cAAA,0PAAC,6JAAQ;wBAAC,WAAW,QAAQ,EAAE;wBAAE,UAAU;;;;;;;;;;;;;;;;;;;;;;AAMvD"}},
    {"offset": {"line": 2596, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/MessageList.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useRef } from \"react\";\nimport MessageBubble from \"./MessageBubble\";\nimport type { Message } from \"./types\";\n\ntype MessageListProps = {\n  messages: Message[];\n  isGenerating?: boolean;\n  toolMode?: string;\n  modelUsed?: string | null;\n};\n\nexport default function MessageList({ messages, isGenerating, toolMode, modelUsed }: MessageListProps) {\n  const bottomRef = useRef<HTMLDivElement>(null);\n\n  // Auto-scroll to bottom when messages change\n  useEffect(() => {\n    bottomRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages, isGenerating]);\n\n  return (\n    <div className=\"scrollbar-thin flex h-full flex-col overflow-y-auto px-4 py-4\">\n      <div className=\"flex-1 space-y-3\">\n        {messages.length === 0 && (\n          <div className=\"flex h-full items-center justify-center\">\n            <div className=\"max-w-md rounded-xl border border-slate-800 bg-slate-900/60 p-6 text-center\">\n              <div className=\"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-cyan-500/10\">\n                <svg className=\"h-6 w-6 text-cyan-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={1.5}>\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M8.625 12a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H8.25m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H12m4.125 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 01-2.555-.337A5.972 5.972 0 015.41 20.97a5.969 5.969 0 01-.474-.065 4.48 4.48 0 00.978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25z\" />\n                </svg>\n              </div>\n              <p className=\"text-base font-semibold text-slate-100\">Welcome to LocalAI</p>\n              <p className=\"mt-2 text-sm text-slate-400\">\n                Ask a question or give a task. The router will auto-select the best local model.\n              </p>\n              <div className=\"mt-4 space-y-2 text-left text-sm text-slate-300\">\n                <div className=\"rounded-lg bg-slate-800/50 px-3 py-2\">\"Summarize today's notes\"</div>\n                <div className=\"rounded-lg bg-slate-800/50 px-3 py-2\">\"Write a Python function for Fibonacci\"</div>\n                <div className=\"rounded-lg bg-slate-800/50 px-3 py-2\">\"Explain this image\"</div>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {messages.map((msg) => (\n          <MessageBubble\n            key={msg.id}\n            message={msg}\n            toolMode={msg.role === \"assistant\" ? toolMode : undefined}\n            modelUsed={msg.role === \"assistant\" ? modelUsed : undefined}\n            showMetadata={true}\n          />\n        ))}\n\n        {isGenerating && (\n          <div className=\"flex justify-start\">\n            <div className=\"rounded-2xl border border-slate-800 bg-slate-900/80 px-4 py-3\">\n              <p className=\"text-[10px] font-semibold uppercase tracking-wider text-slate-500\">Assistant</p>\n              <div className=\"mt-2 flex items-center gap-1.5\">\n                <span className=\"h-2 w-2 animate-bounce rounded-full bg-cyan-400 [animation-delay:-0.3s]\" />\n                <span className=\"h-2 w-2 animate-bounce rounded-full bg-cyan-400 [animation-delay:-0.15s]\" />\n                <span className=\"h-2 w-2 animate-bounce rounded-full bg-cyan-400\" />\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Scroll anchor */}\n        <div ref={bottomRef} />\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAYe,SAAS,YAAY,EAAE,QAAQ,EAAE,YAAY,EAAE,QAAQ,EAAE,SAAS,EAAoB;IACnG,MAAM,YAAY,IAAA,2NAAM,EAAiB;IAEzC,6CAA6C;IAC7C,IAAA,8NAAS,EAAC;QACR,UAAU,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IACzD,GAAG;QAAC;QAAU;KAAa;IAE3B,qBACE,0PAAC;QAAI,WAAU;kBACb,cAAA,0PAAC;YAAI,WAAU;;gBACZ,SAAS,MAAM,KAAK,mBACnB,0PAAC;oBAAI,WAAU;8BACb,cAAA,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAI,WAAU;0CACb,cAAA,0PAAC;oCAAI,WAAU;oCAAwB,MAAK;oCAAO,SAAQ;oCAAY,QAAO;oCAAe,aAAa;8CACxG,cAAA,0PAAC;wCAAK,eAAc;wCAAQ,gBAAe;wCAAQ,GAAE;;;;;;;;;;;;;;;;0CAGzD,0PAAC;gCAAE,WAAU;0CAAyC;;;;;;0CACtD,0PAAC;gCAAE,WAAU;0CAA8B;;;;;;0CAG3C,0PAAC;gCAAI,WAAU;;kDACb,0PAAC;wCAAI,WAAU;kDAAuC;;;;;;kDACtD,0PAAC;wCAAI,WAAU;kDAAuC;;;;;;kDACtD,0PAAC;wCAAI,WAAU;kDAAuC;;;;;;;;;;;;;;;;;;;;;;;gBAM7D,SAAS,GAAG,CAAC,CAAC,oBACb,0PAAC,kKAAa;wBAEZ,SAAS;wBACT,UAAU,IAAI,IAAI,KAAK,cAAc,WAAW;wBAChD,WAAW,IAAI,IAAI,KAAK,cAAc,YAAY;wBAClD,cAAc;uBAJT,IAAI,EAAE;;;;;gBAQd,8BACC,0PAAC;oBAAI,WAAU;8BACb,cAAA,0PAAC;wBAAI,WAAU;;0CACb,0PAAC;gCAAE,WAAU;0CAAoE;;;;;;0CACjF,0PAAC;gCAAI,WAAU;;kDACb,0PAAC;wCAAK,WAAU;;;;;;kDAChB,0PAAC;wCAAK,WAAU;;;;;;kDAChB,0PAAC;wCAAK,WAAU;;;;;;;;;;;;;;;;;;;;;;;8BAOxB,0PAAC;oBAAI,KAAK;;;;;;;;;;;;;;;;;AAIlB"}},
    {"offset": {"line": 2802, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/ResearchProgress.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\n\ntype ResearchProgressProps = {\n  step: number;\n  total: number;\n  message: string;\n  findings?: Array<{ title: string; url: string; snippet: string }>;\n  sources?: string[];\n  isComplete?: boolean;\n  onCancel?: () => void;\n  onDismiss?: () => void;\n};\n\nexport default function ResearchProgress({\n  step,\n  total,\n  message,\n  findings = [],\n  sources = [],\n  isComplete = false,\n  onCancel,\n  onDismiss,\n}: ResearchProgressProps) {\n  const [showDetails, setShowDetails] = useState(false);\n\n  const progressPercent = (step / total) * 100;\n\n  return (\n    <div className=\"rounded-lg border border-cyan-500/30 bg-cyan-500/5 p-4\">\n      <div className=\"mb-3 flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          {!isComplete && (\n            <div className=\"h-2 w-2 animate-pulse rounded-full bg-cyan-400\" />\n          )}\n          <span className=\"text-sm font-semibold text-cyan-300\">\n            {isComplete ? \"Research Complete\" : \"Research in Progress\"}\n          </span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {!isComplete && (\n            <span className=\"text-xs text-slate-400\">\n              Step {step} of {total}\n            </span>\n          )}\n          {!isComplete && onCancel && (\n            <button\n              onClick={onCancel}\n              className=\"ml-2 rounded px-2 py-1 text-xs font-medium text-red-400 hover:bg-red-500/10 hover:text-red-300 transition-colors\"\n              title=\"Cancel research\"\n            >\n              ‚úï Cancel\n            </button>\n          )}\n          {onDismiss && (\n            <button\n              onClick={onDismiss}\n              className=\"ml-2 rounded px-2 py-1 text-xs font-medium text-slate-400 hover:bg-slate-800 hover:text-slate-300 transition-colors\"\n              title=\"Dismiss progress\"\n            >\n              ‚úï\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Progress bar */}\n      <div className=\"mb-3 h-1.5 w-full overflow-hidden rounded-full bg-slate-800\">\n        <div\n          className=\"h-full bg-gradient-to-r from-cyan-500 to-cyan-400 transition-all duration-300\"\n          style={{ width: `${progressPercent}%` }}\n        />\n      </div>\n\n      {/* Current step message */}\n      <p className=\"mb-3 text-sm text-slate-300\">{message}</p>\n\n      {/* Findings */}\n      {findings.length > 0 && (\n        <div className=\"mb-3\">\n          <button\n            onClick={() => setShowDetails(!showDetails)}\n            className=\"mb-2 text-xs font-semibold text-cyan-400 hover:text-cyan-300\"\n          >\n            {showDetails ? \"‚ñº\" : \"‚ñ∂\"} {findings.length} sources found\n          </button>\n          {showDetails && (\n            <div className=\"space-y-2\">\n              {findings.map((finding, idx) => (\n                <div\n                  key={idx}\n                  className=\"rounded border border-slate-800 bg-slate-900/50 p-2 text-xs\"\n                >\n                  <a\n                    href={finding.url}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"font-medium text-cyan-400 hover:underline\"\n                  >\n                    {finding.title}\n                  </a>\n                  <p className=\"mt-1 line-clamp-2 text-slate-400\">{finding.snippet}</p>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Sources list */}\n      {sources.length > 0 && (\n        <div className=\"mt-3 border-t border-slate-800 pt-3\">\n          <p className=\"mb-2 text-xs font-semibold text-slate-400\">Sources:</p>\n          <ul className=\"space-y-1\">\n            {sources.map((source, idx) => (\n              <li key={idx} className=\"text-xs\">\n                <a\n                  href={source}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"text-cyan-400 hover:underline\"\n                >\n                  {idx + 1}. {source}\n                </a>\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {isComplete && (\n        <div className=\"mt-3 rounded border border-green-500/30 bg-green-500/5 p-2 text-xs text-green-300\">\n          ‚úì Research complete\n        </div>\n      )}\n    </div>\n  );\n}\n\n\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAee,SAAS,iBAAiB,EACvC,IAAI,EACJ,KAAK,EACL,OAAO,EACP,WAAW,EAAE,EACb,UAAU,EAAE,EACZ,aAAa,KAAK,EAClB,QAAQ,EACR,SAAS,EACa;IACtB,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,6NAAQ,EAAC;IAE/C,MAAM,kBAAkB,AAAC,OAAO,QAAS;IAEzC,qBACE,0PAAC;QAAI,WAAU;;0BACb,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAI,WAAU;;4BACZ,CAAC,4BACA,0PAAC;gCAAI,WAAU;;;;;;0CAEjB,0PAAC;gCAAK,WAAU;0CACb,aAAa,sBAAsB;;;;;;;;;;;;kCAGxC,0PAAC;wBAAI,WAAU;;4BACZ,CAAC,4BACA,0PAAC;gCAAK,WAAU;;oCAAyB;oCACjC;oCAAK;oCAAK;;;;;;;4BAGnB,CAAC,cAAc,0BACd,0PAAC;gCACC,SAAS;gCACT,WAAU;gCACV,OAAM;0CACP;;;;;;4BAIF,2BACC,0PAAC;gCACC,SAAS;gCACT,WAAU;gCACV,OAAM;0CACP;;;;;;;;;;;;;;;;;;0BAQP,0PAAC;gBAAI,WAAU;0BACb,cAAA,0PAAC;oBACC,WAAU;oBACV,OAAO;wBAAE,OAAO,GAAG,gBAAgB,CAAC,CAAC;oBAAC;;;;;;;;;;;0BAK1C,0PAAC;gBAAE,WAAU;0BAA+B;;;;;;YAG3C,SAAS,MAAM,GAAG,mBACjB,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBACC,SAAS,IAAM,eAAe,CAAC;wBAC/B,WAAU;;4BAET,cAAc,MAAM;4BAAI;4BAAE,SAAS,MAAM;4BAAC;;;;;;;oBAE5C,6BACC,0PAAC;wBAAI,WAAU;kCACZ,SAAS,GAAG,CAAC,CAAC,SAAS,oBACtB,0PAAC;gCAEC,WAAU;;kDAEV,0PAAC;wCACC,MAAM,QAAQ,GAAG;wCACjB,QAAO;wCACP,KAAI;wCACJ,WAAU;kDAET,QAAQ,KAAK;;;;;;kDAEhB,0PAAC;wCAAE,WAAU;kDAAoC,QAAQ,OAAO;;;;;;;+BAX3D;;;;;;;;;;;;;;;;YAoBhB,QAAQ,MAAM,GAAG,mBAChB,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAE,WAAU;kCAA4C;;;;;;kCACzD,0PAAC;wBAAG,WAAU;kCACX,QAAQ,GAAG,CAAC,CAAC,QAAQ,oBACpB,0PAAC;gCAAa,WAAU;0CACtB,cAAA,0PAAC;oCACC,MAAM;oCACN,QAAO;oCACP,KAAI;oCACJ,WAAU;;wCAET,MAAM;wCAAE;wCAAG;;;;;;;+BAPP;;;;;;;;;;;;;;;;YAehB,4BACC,0PAAC;gBAAI,WAAU;0BAAoF;;;;;;;;;;;;AAM3G"}},
    {"offset": {"line": 3040, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/SearchProgress.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { Globe, Loader2, X } from \"lucide-react\";\r\n\r\ninterface SearchProgressProps {\r\n  query: string;\r\n  reason?: string;\r\n  isSearching: boolean;\r\n  onDismiss?: () => void;\r\n}\r\n\r\nexport function SearchProgress({\r\n  query,\r\n  reason,\r\n  isSearching,\r\n  onDismiss,\r\n}: SearchProgressProps) {\r\n  if (!isSearching) return null;\r\n\r\n  return (\r\n    <div className=\"mx-4 mb-3 animate-in fade-in slide-in-from-top-2 duration-300\">\r\n      <div className=\"bg-blue-500/10 border border-blue-500/20 rounded-lg p-3\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"relative\">\r\n              <Globe className=\"h-5 w-5 text-blue-400\" />\r\n              <Loader2 className=\"absolute -top-1 -right-1 h-3 w-3 text-blue-400 animate-spin\" />\r\n            </div>\r\n            <div>\r\n              <div className=\"text-sm font-medium text-blue-300\">\r\n                Searching the web...\r\n              </div>\r\n              {reason && (\r\n                <div className=\"text-xs text-blue-400/70 mt-0.5\">\r\n                  {reason}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n          {onDismiss && (\r\n            <button\r\n              onClick={onDismiss}\r\n              className=\"p-1 hover:bg-blue-500/20 rounded transition-colors\"\r\n              aria-label=\"Dismiss\"\r\n            >\r\n              <X className=\"h-4 w-4 text-blue-400\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n        \r\n        {/* Animated progress bar */}\r\n        <div className=\"mt-3 h-1 bg-blue-900/30 rounded-full overflow-hidden\">\r\n          <div className=\"h-full bg-gradient-to-r from-blue-500 to-cyan-400 rounded-full animate-search-progress\" />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAFA;;;AAWO,SAAS,eAAe,EAC7B,KAAK,EACL,MAAM,EACN,WAAW,EACX,SAAS,EACW;IACpB,IAAI,CAAC,aAAa,OAAO;IAEzB,qBACE,0PAAC;QAAI,WAAU;kBACb,cAAA,0PAAC;YAAI,WAAU;;8BACb,0PAAC;oBAAI,WAAU;;sCACb,0PAAC;4BAAI,WAAU;;8CACb,0PAAC;oCAAI,WAAU;;sDACb,0PAAC,yNAAK;4CAAC,WAAU;;;;;;sDACjB,0PAAC,wOAAO;4CAAC,WAAU;;;;;;;;;;;;8CAErB,0PAAC;;sDACC,0PAAC;4CAAI,WAAU;sDAAoC;;;;;;wCAGlD,wBACC,0PAAC;4CAAI,WAAU;sDACZ;;;;;;;;;;;;;;;;;;wBAKR,2BACC,0PAAC;4BACC,SAAS;4BACT,WAAU;4BACV,cAAW;sCAEX,cAAA,0PAAC,6MAAC;gCAAC,WAAU;;;;;;;;;;;;;;;;;8BAMnB,0PAAC;oBAAI,WAAU;8BACb,cAAA,0PAAC;wBAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;AAKzB"}},
    {"offset": {"line": 3169, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/SearchSources.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { ChevronDown, ChevronUp, ExternalLink, Globe } from \"lucide-react\";\r\nimport type { SearchResult } from \"@/lib/api/chat\";\r\n\r\ninterface SearchSourcesProps {\r\n  results: SearchResult[];\r\n  isCollapsible?: boolean;\r\n  defaultExpanded?: boolean;\r\n}\r\n\r\nexport function SearchSources({\r\n  results,\r\n  isCollapsible = true,\r\n  defaultExpanded = false,\r\n}: SearchSourcesProps) {\r\n  const [isExpanded, setIsExpanded] = useState(defaultExpanded);\r\n\r\n  if (!results || results.length === 0) return null;\r\n\r\n  return (\r\n    <div className=\"mx-4 mb-3 animate-in fade-in slide-in-from-top-2 duration-300\">\r\n      <div className=\"bg-zinc-800/50 border border-zinc-700/50 rounded-lg overflow-hidden\">\r\n        {/* Header */}\r\n        <button\r\n          onClick={() => isCollapsible && setIsExpanded(!isExpanded)}\r\n          className={`w-full flex items-center justify-between p-3 ${\r\n            isCollapsible ? \"hover:bg-zinc-700/30 cursor-pointer\" : \"\"\r\n          } transition-colors`}\r\n          disabled={!isCollapsible}\r\n        >\r\n          <div className=\"flex items-center gap-2\">\r\n            <Globe className=\"h-4 w-4 text-blue-400\" />\r\n            <span className=\"text-sm font-medium text-zinc-300\">\r\n              Web Sources ({results.length})\r\n            </span>\r\n            <span className=\"text-xs text-zinc-500\">\r\n              via {results[0]?.source || \"web\"}\r\n            </span>\r\n          </div>\r\n          {isCollapsible && (\r\n            <div className=\"text-zinc-400\">\r\n              {isExpanded ? (\r\n                <ChevronUp className=\"h-4 w-4\" />\r\n              ) : (\r\n                <ChevronDown className=\"h-4 w-4\" />\r\n              )}\r\n            </div>\r\n          )}\r\n        </button>\r\n\r\n        {/* Expanded content */}\r\n        {(isExpanded || !isCollapsible) && (\r\n          <div className=\"border-t border-zinc-700/50 divide-y divide-zinc-700/30\">\r\n            {results.map((result, index) => (\r\n              <a\r\n                key={index}\r\n                href={result.url}\r\n                target=\"_blank\"\r\n                rel=\"noopener noreferrer\"\r\n                className=\"block p-3 hover:bg-zinc-700/20 transition-colors group\"\r\n              >\r\n                <div className=\"flex items-start gap-3\">\r\n                  <span className=\"flex-shrink-0 w-5 h-5 rounded bg-blue-500/20 text-blue-400 text-xs flex items-center justify-center font-medium\">\r\n                    {index + 1}\r\n                  </span>\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <h4 className=\"text-sm font-medium text-zinc-200 truncate group-hover:text-blue-400 transition-colors\">\r\n                        {result.title}\r\n                      </h4>\r\n                      <ExternalLink className=\"h-3 w-3 text-zinc-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0\" />\r\n                    </div>\r\n                    <p className=\"text-xs text-zinc-400 line-clamp-2 mt-1\">\r\n                      {result.snippet}\r\n                    </p>\r\n                    <span className=\"text-xs text-zinc-500 mt-1 inline-block\">\r\n                      {new URL(result.url).hostname}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </a>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;AAHA;;;;AAYO,SAAS,cAAc,EAC5B,OAAO,EACP,gBAAgB,IAAI,EACpB,kBAAkB,KAAK,EACJ;IACnB,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,6NAAQ,EAAC;IAE7C,IAAI,CAAC,WAAW,QAAQ,MAAM,KAAK,GAAG,OAAO;IAE7C,qBACE,0PAAC;QAAI,WAAU;kBACb,cAAA,0PAAC;YAAI,WAAU;;8BAEb,0PAAC;oBACC,SAAS,IAAM,iBAAiB,cAAc,CAAC;oBAC/C,WAAW,CAAC,6CAA6C,EACvD,gBAAgB,wCAAwC,GACzD,kBAAkB,CAAC;oBACpB,UAAU,CAAC;;sCAEX,0PAAC;4BAAI,WAAU;;8CACb,0PAAC,yNAAK;oCAAC,WAAU;;;;;;8CACjB,0PAAC;oCAAK,WAAU;;wCAAoC;wCACpC,QAAQ,MAAM;wCAAC;;;;;;;8CAE/B,0PAAC;oCAAK,WAAU;;wCAAwB;wCACjC,OAAO,CAAC,EAAE,EAAE,UAAU;;;;;;;;;;;;;wBAG9B,+BACC,0PAAC;4BAAI,WAAU;sCACZ,2BACC,0PAAC,yOAAS;gCAAC,WAAU;;;;;qDAErB,0PAAC,+OAAW;gCAAC,WAAU;;;;;;;;;;;;;;;;;gBAO9B,CAAC,cAAc,CAAC,aAAa,mBAC5B,0PAAC;oBAAI,WAAU;8BACZ,QAAQ,GAAG,CAAC,CAAC,QAAQ,sBACpB,0PAAC;4BAEC,MAAM,OAAO,GAAG;4BAChB,QAAO;4BACP,KAAI;4BACJ,WAAU;sCAEV,cAAA,0PAAC;gCAAI,WAAU;;kDACb,0PAAC;wCAAK,WAAU;kDACb,QAAQ;;;;;;kDAEX,0PAAC;wCAAI,WAAU;;0DACb,0PAAC;gDAAI,WAAU;;kEACb,0PAAC;wDAAG,WAAU;kEACX,OAAO,KAAK;;;;;;kEAEf,0PAAC,kPAAY;wDAAC,WAAU;;;;;;;;;;;;0DAE1B,0PAAC;gDAAE,WAAU;0DACV,OAAO,OAAO;;;;;;0DAEjB,0PAAC;gDAAK,WAAU;0DACb,IAAI,IAAI,OAAO,GAAG,EAAE,QAAQ;;;;;;;;;;;;;;;;;;2BArB9B;;;;;;;;;;;;;;;;;;;;;AAgCrB"}},
    {"offset": {"line": 3360, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/layout/ChatBody.tsx"],"sourcesContent":["\"use client\";\n\nimport MessageList from \"../MessageList\";\nimport ResearchProgress from \"../ResearchProgress\";\nimport { SearchProgress } from \"../SearchProgress\";\nimport { SearchSources } from \"../SearchSources\";\nimport type { Message } from \"../types\";\nimport type { SearchResult } from \"@/lib/api/chat\";\n\ntype ChatBodyProps = {\n  messages: Message[];\n  isGenerating: boolean;\n  toolMode?: string;\n  modelUsed: string | null;\n  searchQuery: string;\n  searchReason: string;\n  isSearching: boolean;\n  onDismissSearch: () => void;\n  searchResults: SearchResult[];\n  researchProgress: {\n    step: number;\n    total: number;\n    message: string;\n    findings: Array<{ title: string; url: string; snippet: string }>;\n    sources: string[];\n    isComplete: boolean;\n  } | null;\n  onCancelResearch: () => void;\n  onDismissResearch: () => void;\n};\n\nexport default function ChatBody({\n  messages,\n  isGenerating,\n  toolMode,\n  modelUsed,\n  searchQuery,\n  searchReason,\n  isSearching,\n  onDismissSearch,\n  searchResults,\n  researchProgress,\n  onCancelResearch,\n  onDismissResearch,\n}: ChatBodyProps) {\n  return (\n    <div className=\"min-h-0 flex-1 overflow-hidden rounded-2xl border border-slate-900/70 bg-slate-900/60 shadow-lg shadow-slate-950/30 flex flex-col\">\n      <div className=\"flex-1 overflow-hidden\">\n        <MessageList\n          messages={messages}\n          isGenerating={isGenerating}\n          toolMode={toolMode}\n          modelUsed={modelUsed}\n        />\n      </div>\n\n      <SearchProgress\n        query={searchQuery}\n        reason={searchReason}\n        isSearching={isSearching}\n        onDismiss={onDismissSearch}\n      />\n\n      {searchResults.length > 0 && !isSearching && (\n        <SearchSources\n          results={searchResults}\n          isCollapsible={true}\n          defaultExpanded={false}\n        />\n      )}\n\n      {researchProgress && (\n        <div className=\"border-t border-slate-800 bg-slate-900/80 p-4\">\n          <ResearchProgress\n            step={researchProgress.step}\n            total={researchProgress.total}\n            message={researchProgress.message}\n            findings={researchProgress.findings}\n            sources={researchProgress.sources}\n            isComplete={researchProgress.isComplete}\n            onCancel={onCancelResearch}\n            onDismiss={onDismissResearch}\n          />\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AA+Be,SAAS,SAAS,EAC/B,QAAQ,EACR,YAAY,EACZ,QAAQ,EACR,SAAS,EACT,WAAW,EACX,YAAY,EACZ,WAAW,EACX,eAAe,EACf,aAAa,EACb,gBAAgB,EAChB,gBAAgB,EAChB,iBAAiB,EACH;IACd,qBACE,0PAAC;QAAI,WAAU;;0BACb,0PAAC;gBAAI,WAAU;0BACb,cAAA,0PAAC,gKAAW;oBACV,UAAU;oBACV,cAAc;oBACd,UAAU;oBACV,WAAW;;;;;;;;;;;0BAIf,0PAAC,0KAAc;gBACb,OAAO;gBACP,QAAQ;gBACR,aAAa;gBACb,WAAW;;;;;;YAGZ,cAAc,MAAM,GAAG,KAAK,CAAC,6BAC5B,0PAAC,wKAAa;gBACZ,SAAS;gBACT,eAAe;gBACf,iBAAiB;;;;;;YAIpB,kCACC,0PAAC;gBAAI,WAAU;0BACb,cAAA,0PAAC,qKAAgB;oBACf,MAAM,iBAAiB,IAAI;oBAC3B,OAAO,iBAAiB,KAAK;oBAC7B,SAAS,iBAAiB,OAAO;oBACjC,UAAU,iBAAiB,QAAQ;oBACnC,SAAS,iBAAiB,OAAO;oBACjC,YAAY,iBAAiB,UAAU;oBACvC,UAAU;oBACV,WAAW;;;;;;;;;;;;;;;;;AAMvB"}},
    {"offset": {"line": 3447, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/ToolSelector.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useRef, useEffect } from \"react\";\nimport type { ToolMode } from \"./MessageInput\";\n\ntype ToolOption = {\n  mode: ToolMode;\n  label: string;\n  icon: string;\n  description: string;\n  shortcut?: string;\n};\n\nconst tools: ToolOption[] = [\n  {\n    mode: \"none\",\n    label: \"Chat\",\n    icon: \"üí¨\",\n    description: \"Standard chat conversation\",\n  },\n  {\n    mode: \"research\",\n    label: \"Research\",\n    icon: \"üîç\",\n    description: \"Deep research with web search & RAG\",\n  },\n  {\n    mode: \"reasoning\",\n    label: \"Reasoning\",\n    icon: \"üß†\",\n    description: \"Force reasoning model for complex analysis\",\n  },\n  {\n    mode: \"vision\",\n    label: \"Image\",\n    icon: \"üñºÔ∏è\",\n    description: \"Image generation and analysis\",\n  },\n];\n\ntype ToolSelectorProps = {\n  value: ToolMode;\n  onChange: (mode: ToolMode) => void;\n  disabled?: boolean;\n  compact?: boolean;\n};\n\nexport default function ToolSelector({ value, onChange, disabled, compact = false }: ToolSelectorProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const dropdownRef = useRef<HTMLDivElement>(null);\n\n  const selectedTool = tools.find((t) => t.mode === value) || tools[0];\n\n  // Close dropdown when clicking outside\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (dropdownRef.current && !dropdownRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n      return () => document.removeEventListener(\"mousedown\", handleClickOutside);\n    }\n  }, [isOpen]);\n\n  // Close on Escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === \"Escape\" && isOpen) {\n        setIsOpen(false);\n      }\n    };\n    document.addEventListener(\"keydown\", handleEscape);\n    return () => document.removeEventListener(\"keydown\", handleEscape);\n  }, [isOpen]);\n\n  // Keyboard shortcut: Cmd/Ctrl+K to open\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if ((e.metaKey || e.ctrlKey) && e.key === \"k\" && !isOpen && !disabled) {\n        e.preventDefault();\n        setIsOpen(true);\n      }\n    };\n    document.addEventListener(\"keydown\", handleKeyDown);\n    return () => document.removeEventListener(\"keydown\", handleKeyDown);\n  }, [isOpen, disabled]);\n\n  return (\n    <div className=\"relative\" ref={dropdownRef}>\n      <button\n        type=\"button\"\n        onClick={() => !disabled && setIsOpen(!isOpen)}\n        disabled={disabled}\n        className={`inline-flex items-center gap-2 rounded-lg border px-3 py-1.5 text-xs font-semibold transition-all ${\n          value !== \"none\"\n            ? \"border-cyan-500/50 bg-cyan-500/10 text-cyan-300\"\n            : \"border-slate-800 bg-slate-900/60 text-slate-400 hover:border-cyan-500/30 hover:text-cyan-200 hover:bg-slate-900/80\"\n        } ${disabled ? \"cursor-not-allowed opacity-50\" : \"\"} ${compact ? \"px-2 py-1\" : \"\"}`}\n        title={selectedTool.description}\n        aria-label={`Select tool. Current: ${selectedTool.label}`}\n        aria-expanded={isOpen}\n        aria-haspopup=\"true\"\n      >\n        <span>{selectedTool.icon}</span>\n        {!compact && <span>{selectedTool.label}</span>}\n        <svg\n          className={`h-3 w-3 transition-transform ${isOpen ? \"rotate-180\" : \"\"}`}\n          fill=\"none\"\n          viewBox=\"0 0 24 24\"\n          stroke=\"currentColor\"\n        >\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n        </svg>\n      </button>\n\n      {isOpen && (\n        <div className=\"absolute bottom-full left-0 z-50 mb-1 w-56 animate-in fade-in slide-in-from-bottom-2 rounded-lg border border-slate-800 bg-slate-900 shadow-xl duration-200\">\n          <div className=\"p-1\">\n            {tools.map((tool) => (\n              <button\n                key={tool.mode}\n                type=\"button\"\n                onClick={() => {\n                  onChange(tool.mode);\n                  setIsOpen(false);\n                }}\n                className={`w-full flex items-center gap-3 rounded-md px-3 py-2 text-left text-sm transition ${\n                  value === tool.mode\n                    ? \"bg-cyan-500/10 text-cyan-300\"\n                    : \"text-slate-300 hover:bg-slate-800 hover:text-slate-100\"\n                }`}\n              >\n                <span className=\"text-base\">{tool.icon}</span>\n                <div className=\"flex-1\">\n                  <div className=\"font-medium\">{tool.label}</div>\n                  <div className=\"text-xs text-slate-500\">{tool.description}</div>\n                </div>\n                {value === tool.mode && (\n                  <svg className=\"h-4 w-4 text-cyan-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                    <path\n                      fillRule=\"evenodd\"\n                      d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\"\n                      clipRule=\"evenodd\"\n                    />\n                  </svg>\n                )}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3670, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/MessageInput.tsx"],"sourcesContent":["\"use client\";\nimport { FormEvent, KeyboardEvent, useState, useRef, useEffect } from \"react\";\nimport ToolSelector from \"./ToolSelector\";\n\nexport type ToolMode = \"none\" | \"research\" | \"reasoning\" | \"vision\" | \"file\";\nexport type Attachment = {\n  type: \"image\" | \"file\";\n  file: File;\n  preview?: string;\n};\n\ntype MessageInputProps = {\n  disabled?: boolean;\n  onSend: (content: string, toolMode?: ToolMode, attachments?: Attachment[]) => void;\n  toolMode?: ToolMode;\n  onToolModeChange?: (mode: ToolMode) => void;\n};\n\nexport default function MessageInput({ disabled, onSend, toolMode: controlledToolMode, onToolModeChange }: MessageInputProps) {\n  const [value, setValue] = useState(\"\");\n  const [internalToolMode, setInternalToolMode] = useState<ToolMode>(\"none\");\n  const [attachments, setAttachments] = useState<Attachment[]>([]);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  \n  // Use controlled mode if provided, otherwise use internal state\n  const toolMode = controlledToolMode ?? internalToolMode;\n  const setToolMode = (mode: ToolMode | ((current: ToolMode) => ToolMode)) => {\n    if (onToolModeChange) {\n      // If controlled, call the callback with the value directly\n      const newMode = typeof mode === \"function\" ? mode(toolMode) : mode;\n      onToolModeChange(newMode);\n    } else {\n      // If uncontrolled, use functional update\n      if (typeof mode === \"function\") {\n        setInternalToolMode(mode);\n      } else {\n        setInternalToolMode(mode);\n      }\n    }\n  };\n\n  // Auto-resize textarea based on content\n  useEffect(() => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      textarea.style.height = \"auto\";\n      textarea.style.height = `${Math.min(textarea.scrollHeight, 150)}px`;\n    }\n  }, [value]);\n\n  // Sync with controlled tool mode\n  useEffect(() => {\n    if (controlledToolMode !== undefined) {\n      setInternalToolMode(controlledToolMode);\n    }\n  }, [controlledToolMode]);\n\n  const handleSubmit = (e?: FormEvent) => {\n    e?.preventDefault();\n    const content = value.trim();\n    if ((!content && attachments.length === 0) || disabled) return;\n    onSend(content, toolMode !== \"none\" ? toolMode : undefined, attachments.length > 0 ? attachments : undefined);\n    setValue(\"\");\n    setAttachments([]);\n    // Reset tool mode after sending (except for research which may need follow-up)\n    if (toolMode !== \"research\") {\n      setToolMode(\"none\");\n    }\n  };\n\n  const handleFileSelect = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const files = Array.from(e.target.files || []);\n    const newAttachments: Attachment[] = [];\n\n    files.forEach((file) => {\n      if (file.type.startsWith(\"image/\")) {\n        const reader = new FileReader();\n        reader.onload = (e) => {\n          const preview = e.target?.result as string;\n          setAttachments((prev) => {\n            const existing = prev.find((a) => a.file.name === file.name);\n            if (existing) return prev;\n            return [...prev, { type: \"image\", file, preview }];\n          });\n        };\n        reader.readAsDataURL(file);\n        newAttachments.push({ type: \"image\", file });\n      } else {\n        newAttachments.push({ type: \"file\", file });\n      }\n    });\n\n    setAttachments((prev) => [...prev, ...newAttachments]);\n    if (fileInputRef.current) {\n      fileInputRef.current.value = \"\";\n    }\n  };\n\n  const removeAttachment = (index: number) => {\n    setAttachments((prev) => prev.filter((_, i) => i !== index));\n  };\n\n  const toggleToolMode = (mode: ToolMode) => {\n    const newMode = toolMode === mode ? \"none\" : mode;\n    setToolMode(newMode);\n  };\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>) => {\n    // Enter without Shift sends the message\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit();\n    }\n    // Shift+Enter allows newline (default behavior)\n    // Escape clears input\n    if (e.key === \"Escape\") {\n      setValue(\"\");\n      setAttachments([]);\n    }\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center gap-2\">\n        <ToolSelector\n          value={toolMode}\n          onChange={setToolMode}\n          disabled={disabled}\n        />\n      </div>\n      \n      {/* Attachment previews */}\n      {attachments.length > 0 && (\n        <div className=\"flex flex-wrap gap-2\">\n          {attachments.map((attachment, index) => (\n            <div\n              key={index}\n              className=\"relative rounded-lg border border-slate-800 bg-slate-900/60 p-2\"\n            >\n              {attachment.type === \"image\" && attachment.preview ? (\n                <div className=\"relative\">\n                  <img\n                    src={attachment.preview}\n                    alt={attachment.file.name}\n                    className=\"h-20 w-20 rounded object-cover\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => removeAttachment(index)}\n                    className=\"absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full bg-red-500 text-xs text-white hover:bg-red-600\"\n                  >\n                    √ó\n                  </button>\n                </div>\n              ) : (\n                <div className=\"flex items-center gap-2\">\n                  <span className=\"text-lg\">üìé</span>\n                  <span className=\"max-w-[100px] truncate text-xs text-slate-400\">\n                    {attachment.file.name}\n                  </span>\n                  <button\n                    type=\"button\"\n                    onClick={() => removeAttachment(index)}\n                    className=\"text-red-400 hover:text-red-300\"\n                  >\n                    √ó\n                  </button>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n      )}\n      \n      <textarea\n        ref={textareaRef}\n        value={value}\n        onChange={(e) => setValue(e.target.value)}\n        onKeyDown={handleKeyDown}\n        placeholder={\n          toolMode === \"research\"\n            ? \"Enter your research topic‚Ä¶ (AI will ask clarifying questions)\"\n            : toolMode === \"vision\"\n            ? \"Describe the image or ask about it‚Ä¶\"\n            : \"Ask anything‚Ä¶ (Enter to send, Shift+Enter for newline)\"\n        }\n        rows={1}\n        disabled={disabled}\n        className={`max-h-[150px] min-h-[44px] w-full resize-none rounded-xl border bg-slate-950/70 px-4 py-3 text-sm text-slate-100 shadow-inner shadow-slate-950/30 outline-none ring-1 ring-transparent transition focus:ring-cyan-500 disabled:cursor-not-allowed disabled:opacity-60 ${\n          toolMode === \"research\"\n            ? \"border-cyan-500/50\"\n            : toolMode !== \"none\"\n            ? \"border-purple-500/50\"\n            : \"border-slate-800\"\n        }`}\n      />\n      <div className=\"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between\">\n        <div className=\"text-xs text-slate-500\">\n          {toolMode === \"research\" && (\n            <span className=\"mr-2 text-cyan-400\">üîç Research mode active</span>\n          )}\n          <span className=\"hidden sm:inline\">\n            <kbd className=\"rounded bg-slate-800 px-1.5 py-0.5 font-mono text-[10px]\">Enter</kbd>\n            {\" \"}to send\n            <span className=\"mx-2 text-slate-700\">‚Ä¢</span>\n            <kbd className=\"rounded bg-slate-800 px-1.5 py-0.5 font-mono text-[10px]\">Shift</kbd>\n            {\" + \"}\n            <kbd className=\"rounded bg-slate-800 px-1.5 py-0.5 font-mono text-[10px]\">Enter</kbd>\n            {\" \"}for newline\n          </span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          {/* Attach file button - always available */}\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            multiple\n            accept=\"*\"\n            onChange={handleFileSelect}\n            className=\"hidden\"\n          />\n          <button\n            type=\"button\"\n            onClick={() => fileInputRef.current?.click()}\n            disabled={disabled}\n            className=\"inline-flex items-center justify-center gap-1.5 rounded-lg border border-slate-700 bg-slate-900/60 px-3 py-2 text-sm font-medium text-slate-300 transition hover:border-cyan-500/50 hover:bg-slate-800 hover:text-cyan-200 disabled:cursor-not-allowed disabled:opacity-50\"\n            title=\"Attach file\"\n            aria-label=\"Attach file\"\n          >\n            <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13\" />\n            </svg>\n            <span className=\"hidden sm:inline\">Attach</span>\n          </button>\n          <button\n            type=\"submit\"\n            disabled={disabled || (!value.trim() && attachments.length === 0)}\n            className=\"inline-flex items-center justify-center gap-2 rounded-lg bg-cyan-500 px-4 py-2 text-sm font-semibold text-slate-900 transition-all hover:bg-cyan-400 hover:shadow-lg hover:shadow-cyan-500/20 disabled:cursor-not-allowed disabled:opacity-50 disabled:hover:shadow-none\"\n            aria-label=\"Send message\"\n          >\n            <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" strokeWidth={2}>\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n            </svg>\n            Send\n          </button>\n        </div>\n      </div>\n    </form>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4083, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/layout/ChatInputSection.tsx"],"sourcesContent":["\"use client\";\n\nimport MessageInput, { type ToolMode, type Attachment } from \"../MessageInput\";\n\ntype ChatInputSectionProps = {\n  disabled: boolean;\n  onSend: (content: string, toolMode?: ToolMode, attachments?: Attachment[]) => void;\n  toolMode: ToolMode;\n  onToolModeChange: (toolMode: ToolMode) => void;\n};\n\nexport default function ChatInputSection({\n  disabled,\n  onSend,\n  toolMode,\n  onToolModeChange,\n}: ChatInputSectionProps) {\n  return (\n    <div className=\"shrink-0 rounded-2xl border border-slate-900/70 bg-slate-900/70 p-4 shadow-lg shadow-slate-950/30\">\n      <MessageInput\n        disabled={disabled}\n        onSend={onSend}\n        toolMode={toolMode}\n        onToolModeChange={onToolModeChange}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAWe,SAAS,iBAAiB,EACvC,QAAQ,EACR,MAAM,EACN,QAAQ,EACR,gBAAgB,EACM;IACtB,qBACE,0PAAC;QAAI,WAAU;kBACb,cAAA,0PAAC,iKAAY;YACX,UAAU;YACV,QAAQ;YACR,UAAU;YACV,kBAAkB;;;;;;;;;;;AAI1B"}},
    {"offset": {"line": 4115, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/jcgus/Documents/beastAI/frontend/src/components/chat/ChatInterface.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\nimport MessageList from \"./MessageList\";\nimport MessageInput, { type ToolMode, type Attachment } from \"./MessageInput\";\nimport type { Message } from \"./types\";\nimport { useChatStore } from \"@/lib/stores/chat\";\nimport { useHydrated } from \"@/lib/hooks/useHydrated\";\nimport { useAppStore, type AppMode } from \"@/lib/stores/app\";\nimport { streamChat, type SearchResult } from \"@/lib/api/chat\";\nimport { streamResearch } from \"@/lib/api/research\";\n\nimport type { RoutingInfo } from \"./types\";\nimport { useOffline } from \"@/lib/hooks/useOffline\";\n\nimport ChatHeader from \"./layout/ChatHeader\";\nimport ChatBody from \"./layout/ChatBody\";\nimport ChatInputSection from \"./layout/ChatInputSection\";\n\ntype ChatInterfaceProps = {\n  initialMessages?: Message[];\n};\n\nexport default function ChatInterface({ initialMessages }: ChatInterfaceProps) {\n  const hydrated = useHydrated();\n\n  const activeId = useChatStore((state) => state.activeId);\n  const conversations = useChatStore((state) => state.conversations);\n  const isGenerating = useChatStore((state) => state.isGenerating);\n  const createConversation = useChatStore((state) => state.createConversation);\n  const setActiveConversation = useChatStore((state) => state.setActiveConversation);\n  const addMessage = useChatStore((state) => state.addMessage);\n  const replaceMessages = useChatStore((state) => state.replaceMessages);\n  const setIsGenerating = useChatStore((state) => state.setIsGenerating);\n  const setRoutingInfo = useChatStore((state) => state.setRoutingInfo);\n  const routingInfo = useChatStore((state) =>\n    activeId ? state.routingInfo[activeId] ?? null : null\n  );\n  const currentModel = useChatStore((state) =>\n    activeId ? state.currentModel[activeId] ?? null : null\n  );\n  const selectedModel = useChatStore((state) => state.selectedModel);\n  const smartRoutingEnabled = useChatStore((state) => state.smartRoutingEnabled);\n\n  // Get app mode and sync with tool mode\n  const appMode = useAppStore((state) => state.mode);\n  const setAppMode = useAppStore((state) => state.setMode);\n  const [activeToolMode, setActiveToolMode] = useState<ToolMode>(\"none\");\n\n  // Determine effective model: \"auto\" if smart routing is on, otherwise the selected model\n  const effectiveModel = smartRoutingEnabled ? \"auto\" : selectedModel;\n\n  // Sync app mode with tool mode with smooth transition\n  useEffect(() => {\n    const modeToTool: Record<AppMode, ToolMode> = {\n      chat: \"none\",\n      research: \"research\",\n      code: \"reasoning\", // Code mode uses reasoning tool\n      image: \"vision\",\n    };\n    const newToolMode = modeToTool[appMode];\n    if (newToolMode !== activeToolMode) {\n      // Smooth transition - preserve conversation context\n      setActiveToolMode(newToolMode);\n    }\n  }, [appMode, activeToolMode]);\n\n  const seededRef = useRef(false);\n  const abortRef = useRef<AbortController | null>(null);\n  const assistantMsgIdRef = useRef<string>(\"\");\n\n  useEffect(() => {\n    if (!activeId) {\n      const id = createConversation(\"New chat\");\n      setActiveConversation(id);\n      return;\n    }\n\n    if (seededRef.current) return;\n    if (initialMessages && initialMessages.length) {\n      initialMessages.forEach((msg) => addMessage(msg, activeId));\n    }\n    seededRef.current = true;\n  }, [activeId, addMessage, createConversation, initialMessages, setActiveConversation]);\n\n  const currentMessages = activeId ? conversations[activeId]?.messages ?? [] : [];\n\n  const appendAssistantChunk = (id: string, chunk: string) => {\n    if (!activeId) return;\n    useChatStore.setState((state) => {\n      const conversation = state.conversations[activeId];\n      if (!conversation) return state;\n\n      const messages = conversation.messages.map((msg) => {\n        if (msg.id === id) {\n          return {\n            ...msg,\n            content: msg.content + chunk,\n          };\n        }\n        return msg;\n      });\n\n      return {\n        conversations: {\n          ...state.conversations,\n          [activeId]: { ...conversation, messages, updatedAt: Date.now() },\n        },\n      };\n    });\n  };\n\n  const updateAssistantMessage = (id: string, newContent: string, error = false) => {\n    if (!activeId) return;\n    useChatStore.setState((state) => {\n      const conversation = state.conversations[activeId];\n      if (!conversation) return state;\n\n      const messages = conversation.messages.map((msg) => {\n        if (msg.id === id) {\n          return { ...msg, content: newContent, error };\n        }\n        return msg;\n      });\n\n      return {\n        conversations: {\n          ...state.conversations,\n          [activeId]: { ...conversation, messages, updatedAt: Date.now() },\n        },\n      };\n    });\n  };\n\n  const [showRouting, setShowRouting] = useState(false);\n  const [researchProgress, setResearchProgress] = useState<{\n    step: number;\n    total: number;\n    message: string;\n    findings: Array<{ title: string; url: string; snippet: string }>;\n    sources: string[];\n    isComplete: boolean;\n  } | null>(null);\n  \n  // Web search state\n  const [isSearching, setIsSearching] = useState(false);\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [searchReason, setSearchReason] = useState(\"\");\n  const [searchResults, setSearchResults] = useState<SearchResult[]>([]);\n  \n  const offline = useOffline();\n\n  const handleSend = async (content: string, toolMode?: ToolMode, attachments?: Attachment[]) => {\n    if ((!content.trim() && (!attachments || attachments.length === 0)) || !activeId || offline) return;\n    \n    const effectiveToolMode = toolMode ?? activeToolMode;\n    \n    if (effectiveToolMode !== \"none\") {\n      const toolToMode: Record<ToolMode, AppMode | null> = {\n        none: \"chat\", research: \"research\", reasoning: \"code\", vision: \"image\", file: \"chat\",\n      };\n      const newMode = toolToMode[effectiveToolMode];\n      if (newMode && newMode !== appMode) setAppMode(newMode);\n    }\n    \n    const imageBase64: string[] = [];\n    if (attachments) {\n      for (const attachment of attachments) {\n        if (attachment.type === \"image\" && attachment.preview) {\n          const base64 = attachment.preview.split(\",\")[1];\n          if (base64) imageBase64.push(base64);\n        }\n      }\n    }\n    \n    // For vision mode with an image, use the dedicated upload endpoint\n    if (effectiveToolMode === \"vision\" && attachments && attachments.length > 0) {\n      const imageAttachment = attachments.find((a) => a.type === \"image\");\n      if (imageAttachment) {\n        const userMessageId = crypto.randomUUID();\n        addMessage({\n          id: userMessageId,\n          role: \"user\",\n          content: content || \"Analyze this image.\",\n          imageUrl: imageAttachment.preview,\n        }, activeId);\n\n        const assistantMessageId = crypto.randomUUID();\n        assistantMsgIdRef.current = assistantMessageId;\n        addMessage({ id: assistantMessageId, role: \"assistant\", content: \"üîç Analyzing image‚Ä¶\" }, activeId);\n        setIsGenerating(true);\n\n        try {\n          const formData = new FormData();\n          formData.append(\"file\", imageAttachment.file);\n          formData.append(\"prompt\", content || \"What is in this image? Describe in detail.\");\n\n          const res = await fetch(\"http://localhost:8001/api/image/analyze/upload\", {\n            method: \"POST\",\n            body: formData,\n          });\n\n          if (!res.ok) {\n            const err = await res.text();\n            updateAssistantMessage(assistantMessageId, `‚ö†Ô∏è Vision analysis failed: ${err}`, true);\n          } else {\n            const data = await res.json();\n            updateAssistantMessage(assistantMessageId, data.analysis ?? \"No analysis returned.\");\n          }\n        } catch (err) {\n          updateAssistantMessage(assistantMessageId, `‚ö†Ô∏è Vision error: ${String(err)}`, true);\n        } finally {\n          setIsGenerating(false);\n        }\n        return;\n      }\n    }\n\n    const userMessageId = crypto.randomUUID();\n    addMessage({ id: userMessageId, role: \"user\", content }, activeId);\n\n    const assistantMessageId = crypto.randomUUID();\n    assistantMsgIdRef.current = assistantMessageId;\n    addMessage({ id: assistantMessageId, role: \"assistant\", content: \"...\" }, activeId);\n    \n    setIsGenerating(true);\n    abortRef.current?.abort();\n    abortRef.current = new AbortController();\n\n    const previous = [\n      ...currentMessages.map((msg) => ({ role: msg.role, content: msg.content })),\n      { role: \"user\", content, images: imageBase64.length > 0 ? imageBase64 : undefined },\n    ];\n\n    if (effectiveToolMode === \"research\") {\n      try {\n        setResearchProgress({ step: 0, total: 6, message: \"Starting research...\", findings: [], sources: [], isComplete: false });\n        updateAssistantMessage(assistantMessageId, \"\"); // Clear the placeholder\n\n        await streamResearch(\n          content,\n          previous.slice(0, -1),\n          { signal: abortRef.current.signal },\n          {\n            onQuestion: (questions) => {\n              appendAssistantChunk(assistantMessageId, questions);\n              setResearchProgress((prev) => prev ? { ...prev, message: \"Waiting for your response...\" } : null);\n            },\n            onProgress: (step, total, message) => setResearchProgress((prev) => prev ? { ...prev, step, total, message } : null),\n            onFinding: (finding) => setResearchProgress((prev) => prev ? { ...prev, findings: [...prev.findings, finding] } : null),\n            onReport: (chunk) => appendAssistantChunk(assistantMessageId, chunk),\n            onSources: (sources) => setResearchProgress((prev) => prev ? { ...prev, sources } : null),\n            onDone: (data) => {\n              if (data?.phase === \"clarification\") {\n                setIsGenerating(false);\n              } else {\n                setResearchProgress((prev) => prev ? { ...prev, isComplete: true, message: \"Research complete\" } : null);\n                setIsGenerating(false);\n              }\n            },\n            onError: (error) => {\n              console.error(\"Research error\", error);\n              updateAssistantMessage(assistantMessageId, `‚ö†Ô∏è Research error: ${error}`, true);\n              setIsGenerating(false);\n              setResearchProgress(null);\n            },\n          }\n        );\n      } catch (error) {\n        console.error(\"streamResearch failed\", error);\n        updateAssistantMessage(assistantMessageId, \"‚ö†Ô∏è Unable to stream research response.\", true);\n        setIsGenerating(false);\n        setResearchProgress(null);\n      }\n      return;\n    }\n\n    setIsSearching(false);\n    setSearchQuery(\"\");\n    setSearchReason(\"\");\n    setSearchResults([]);\n    \n    try {\n      let firstChunk = true;\n      await streamChat(\n        previous,\n        { signal: abortRef.current.signal, model: effectiveModel, images: imageBase64.length > 0 ? imageBase64 : undefined },\n        {\n          onDelta: (chunk) => {\n            if (firstChunk) {\n              updateAssistantMessage(assistantMessageId, chunk);\n              firstChunk = false;\n            } else {\n              appendAssistantChunk(assistantMessageId, chunk);\n            }\n          },\n          onRouting: (payload) => { if (activeId) setRoutingInfo(activeId, payload as RoutingInfo); },\n          onSearchStart: (payload) => { setIsSearching(true); setSearchQuery(payload.query); setSearchReason(payload.reason || \"\"); },\n          onSearchResults: (payload) => { setIsSearching(false); setSearchResults(payload.results); },\n          onSearchError: (error) => { console.error(\"search error\", error); setIsSearching(false); },\n          onDone: (payload) => {\n            setIsGenerating(false);\n            setIsSearching(false);\n            if (payload?.sources && payload.sources.length > 0 && searchResults.length === 0) {\n              setSearchResults(payload.sources.map((url: string) => ({ title: new URL(url).hostname, url, snippet: \"\", source: \"web\" })));\n            }\n          },\n          onError: (message) => {\n            console.error(\"stream error\", message);\n            updateAssistantMessage(assistantMessageId, `‚ö†Ô∏è ${message}`, true);\n            setIsGenerating(false);\n            setIsSearching(false);\n          },\n        }\n      );\n    } catch (error) {\n      console.error(\"streamChat failed\", error);\n      updateAssistantMessage(assistantMessageId, \"‚ö†Ô∏è Unable to stream response.\", true);\n      setIsGenerating(false);\n      setIsSearching(false);\n    }\n  };\n\n  if (!hydrated) {\n    return (\n      <div className=\"flex h-full flex-col gap-3\">\n        <div className=\"flex-1 rounded-2xl border border-slate-900/70 bg-slate-900/60 p-6\">\n          <div className=\"space-y-3\">\n            {[...Array(4)].map((_, idx) => (\n              <div key={idx} className=\"h-16 animate-pulse rounded-xl bg-slate-800/80\" />\n            ))}\n          </div>\n        </div>\n        <div className=\"rounded-2xl border border-slate-900/70 bg-slate-900/70 p-4\">\n          <div className=\"h-12 animate-pulse rounded-xl bg-slate-800/80\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-full flex-col gap-3\">\n      <ChatHeader\n        routingInfo={routingInfo}\n        currentModel={currentModel}\n        showRouting={showRouting}\n        onToggleRouting={() => setShowRouting((v) => !v)}\n        offline={offline}\n        appMode={appMode}\n      />\n\n      <ChatBody\n        messages={currentMessages}\n        isGenerating={isGenerating}\n        toolMode={activeToolMode !== \"none\" ? activeToolMode : undefined}\n        modelUsed={currentModel}\n        searchQuery={searchQuery}\n        searchReason={searchReason}\n        isSearching={isSearching}\n        onDismissSearch={() => {\n          setIsSearching(false);\n          abortRef.current?.abort();\n        }}\n        searchResults={searchResults}\n        researchProgress={researchProgress}\n        onCancelResearch={() => {\n          console.log(\"Cancelling research...\");\n          abortRef.current?.abort();\n          setIsGenerating(false);\n          setResearchProgress(null);\n          appendAssistantChunk(assistantMsgIdRef.current, \"\\n\\n‚ö†Ô∏è Research cancelled by user.\");\n        }}\n        onDismissResearch={() => {\n          console.log(\"Dismissing research progress...\");\n          if (!researchProgress?.isComplete) {\n            abortRef.current?.abort();\n            setIsGenerating(false);\n            appendAssistantChunk(assistantMsgIdRef.current, \"\\n\\n‚ö†Ô∏è Research cancelled.\");\n          }\n          setResearchProgress(null);\n        }}\n      />\n\n      <ChatInputSection\n        disabled={isGenerating || offline}\n        onSend={handleSend}\n        toolMode={activeToolMode}\n        onToolModeChange={setActiveToolMode}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}